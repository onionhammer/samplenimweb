/* Generated by Nim Compiler v0.10.2 */
/*   (c) 2014 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: MacOSX, amd64, clang */
/* Command for C compiler:
   clang -c  -w  -I/Users/erikoleary/lib/Nim/lib -o /Users/erikoleary/Documents/onion-nimrod/sampleweb/nimcache/stdlib_selectors.o /Users/erikoleary/Documents/onion-nimrod/sampleweb/nimcache/stdlib_selectors.c */
#define NIM_INTBITS 64
#include "nimbase.h"

#include <sys/select.h>

#include <string.h>
typedef struct table161446 table161446;
typedef struct keyvaluepairseq161449 keyvaluepairseq161449;
typedef struct keyvaluepair161452 keyvaluepair161452;
typedef struct selectorkeyHEX3Aobjecttype161426 selectorkeyHEX3Aobjecttype161426;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct selectorHEX3Aobjecttype161440 selectorHEX3Aobjecttype161440;
typedef struct valueerror3249 valueerror3249;
typedef struct Exception Exception;
typedef struct NimStringDesc NimStringDesc;
typedef struct tcell45335 tcell45335;
typedef struct tcellseq45351 tcellseq45351;
typedef struct tgcheap47416 tgcheap47416;
typedef struct tcellset45347 tcellset45347;
typedef struct tpagedesc45343 tpagedesc45343;
typedef struct tmemregion27610 tmemregion27610;
typedef struct tsmallchunk26840 tsmallchunk26840;
typedef struct tllchunk27604 tllchunk27604;
typedef struct tbigchunk26842 tbigchunk26842;
typedef struct tintset26817 tintset26817;
typedef struct ttrunk26813 ttrunk26813;
typedef struct tavlnode27608 tavlnode27608;
typedef struct tgcstat47414 tgcstat47414;
typedef struct TY162136 TY162136;
typedef struct readyinfo161423 readyinfo161423;
typedef struct tbasechunk26838 tbasechunk26838;
typedef struct tfreecell26830 tfreecell26830;
struct keyvaluepair161452 {
NU8 Field0;
int Field1;
selectorkeyHEX3Aobjecttype161426* Field2;
};
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  table161446  {
keyvaluepairseq161449* Data;
NI Counter;
};
struct  selectorkeyHEX3Aobjecttype161426  {
int Fd;
NU8 Events;
TNimObject* Data;
};
typedef N_NIMCALL_PTR(void, TY3089) (void* p, NI op);
typedef N_NIMCALL_PTR(void*, TY3094) (void* p);
struct  TNimType  {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY3089 marker;
TY3094 deepcopy;
};
struct  TNimNode  {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct  selectorHEX3Aobjecttype161440  {
table161446 Fds;
};
struct  TNimObject  {
TNimType* m_type;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct  Exception  {
  TNimObject Sup;
Exception* parent;
NCSTRING name;
NimStringDesc* message;
NimStringDesc* trace;
};
struct  valueerror3249  {
  Exception Sup;
};
struct  tcell45335  {
NI Refcount;
TNimType* Typ;
};
struct  tcellseq45351  {
NI Len;
NI Cap;
tcell45335** D;
};
struct  tcellset45347  {
NI Counter;
NI Max;
tpagedesc45343* Head;
tpagedesc45343** Data;
};
typedef tsmallchunk26840* TY27622[512];
typedef ttrunk26813* ttrunkbuckets26815[256];
struct  tintset26817  {
ttrunkbuckets26815 Data;
};
struct  tmemregion27610  {
NI Minlargeobj;
NI Maxlargeobj;
TY27622 Freesmallchunks;
tllchunk27604* Llmem;
NI Currmem;
NI Maxmem;
NI Freemem;
NI Lastsize;
tbigchunk26842* Freechunkslist;
tintset26817 Chunkstarts;
tavlnode27608* Root;
tavlnode27608* Deleted;
tavlnode27608* Last;
tavlnode27608* Freeavlnodes;
};
struct  tgcstat47414  {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
NI64 Maxpause;
};
struct  tgcheap47416  {
void* Stackbottom;
NI Cyclethreshold;
tcellseq45351 Zct;
tcellseq45351 Decstack;
tcellset45347 Cycleroots;
tcellseq45351 Tempstack;
NI Recgclock;
tmemregion27610 Region;
tgcstat47414 Stat;
};
struct readyinfo161423 {
selectorkeyHEX3Aobjecttype161426* Field0;
NU8 Field1;
};
typedef NI TY26820[8];
struct  tpagedesc45343  {
tpagedesc45343* Next;
NI Key;
TY26820 Bits;
};
struct  tbasechunk26838  {
NI Prevsize;
NI Size;
NIM_BOOL Used;
};
struct  tsmallchunk26840  {
  tbasechunk26838 Sup;
tsmallchunk26840* Next;
tsmallchunk26840* Prev;
tfreecell26830* Freelist;
NI Free;
NI Acc;
NF Data;
};
struct  tllchunk27604  {
NI Size;
NI Acc;
tllchunk27604* Next;
};
struct  tbigchunk26842  {
  tbasechunk26838 Sup;
tbigchunk26842* Next;
tbigchunk26842* Prev;
NI Align;
NF Data;
};
struct  ttrunk26813  {
ttrunk26813* Next;
NI Key;
TY26820 Bits;
};
typedef tavlnode27608* TY27614[2];
struct  tavlnode27608  {
TY27614 Link;
NI Key;
NI Upperbound;
NI Level;
};
struct  tfreecell26830  {
tfreecell26830* Next;
NI Zerofield;
};
struct keyvaluepairseq161449 {
  TGenericSeq Sup;
  keyvaluepair161452 data[SEQ_DECL_SIZE];
};
struct TY162136 {
  TGenericSeq Sup;
  readyinfo161423 data[SEQ_DECL_SIZE];
};
N_NIMCALL(NIM_BOOL, haskey_161476)(table161446 t_161483, int key_161486);
N_NIMCALL(NI, rawget_161490)(table161446 t_161497, int key_161500);
N_NIMCALL(void, HEX5BHEX5DHEX3D_161559)(table161446* t_161568, int key_161572, selectorkeyHEX3Aobjecttype161426* val_161574);
N_NIMCALL(void, nimGCvisit)(void* d, NI op);
N_NIMCALL(void, TMP350)(void* p, NI op);
N_NIMCALL(void, enlarge_161604)(table161446* t_161613);
N_NIMCALL(void, rawinsert_161674)(table161446* t_161683, keyvaluepairseq161449** data_161691, int key_161695, selectorkeyHEX3Aobjecttype161426* val_161697);
N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, HEX5BHEX5D_161849)(table161446 t_161856, int key_161859);
N_NIMCALL(void, del_161919)(table161446* t_161928, int key_161932);
N_NIMCALL(void, inittable_162395)(NI initialsize_162400, table161446* Result);
N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, register_161466)(selectorHEX3Aobjecttype161440* s, int fd, NU8 events, TNimObject* data);
N_NIMCALL(void*, newObj)(TNimType* typ, NI size);
N_NIMCALL(NimStringDesc*, copyStringRC1)(NimStringDesc* src);
static N_INLINE(void, nimGCunrefNoCycle)(void* p);
static N_INLINE(tcell45335*, usrtocell_49046)(void* usr);
static N_INLINE(void, nimFrame)(TFrame* s);
N_NOINLINE(void, stackoverflow_19001)(void);
static N_INLINE(void, popFrame)(void);
static N_INLINE(void, rtladdzct_50604)(tcell45335* c);
N_NOINLINE(void, addzct_49017)(tcellseq45351* s, tcell45335* c);
N_NIMCALL(void, raiseException)(Exception* e, NCSTRING ename);
static N_INLINE(void, asgnRef)(void** dest, void* src);
static N_INLINE(void, incref_51425)(tcell45335* c);
static N_INLINE(NIM_BOOL, canbecycleroot_49067)(tcell45335* c);
static N_INLINE(void, rtladdcycleroot_49829)(tcell45335* c);
N_NOINLINE(void, incl_46071)(tcellset45347* s, tcell45335* cell);
static N_INLINE(void, decref_51004)(tcell45335* c);
N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, update_161806)(selectorHEX3Aobjecttype161440* s, int fd, NU8 events);
N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, unregister_161897)(selectorHEX3Aobjecttype161440* s, int fd);
N_NIMCALL(void, close_161967)(selectorHEX3Aobjecttype161440* s);
N_NIMCALL(struct timeval, timevalfrommilliseconds_161973)(NI timeout);
static N_INLINE(NI, divInt)(NI a, NI b);
N_NOINLINE(void, raiseDivByZero)(void);
N_NOINLINE(void, raiseOverflow)(void);
static N_INLINE(NI, chckRange)(NI i, NI a, NI b);
N_NOINLINE(void, raiseRangeError)(NI64 val);
N_NIMCALL(NI, mulInt)(NI a, NI b);
static N_INLINE(NI, subInt)(NI a, NI b);
N_NIMCALL(void, createfdset_161984)(fd_set* rd, fd_set* wr, table161446 fds, NI* m);
N_NOINLINE(void, raiseIndexError)(void);
static N_INLINE(NI, addInt)(NI a, NI b);
N_NIMCALL(TY162136*, getreadyfds_162127)(fd_set* rd, fd_set* wr, table161446 fds);
N_NIMCALL(void, TMP360)(void* p, NI op);
N_NIMCALL(void*, newSeq)(TNimType* typ, NI len);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* seq, NI elemsize);
N_NIMCALL(TY162136*, select_162279)(table161446 fds, NI timeout);
N_NIMCALL(void, raiseoserror_123009)(NI32 errorcode);
N_NIMCALL(NI32, oslasterror_123041)(void);
N_NIMCALL(TY162136*, select_162365)(selectorHEX3Aobjecttype161440* s, NI timeout);
N_NIMCALL(selectorHEX3Aobjecttype161440*, newselector_162375)(void);
N_NIMCALL(void, TMP364)(void* p, NI op);
N_NIMCALL(NIM_BOOL, contains_162624)(selectorHEX3Aobjecttype161440* s, int fd);
N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, HEX5BHEX5D_162646)(selectorHEX3Aobjecttype161440* s, int fd);
N_NIMCALL(NIM_BOOL, contains_162804)(selectorHEX3Aobjecttype161440* s, selectorkeyHEX3Aobjecttype161426* key);
STRING_LITERAL(TMP353, "File descriptor already exists.", 31);
STRING_LITERAL(TMP354, "File descriptor not found.", 26);
TNimType NTI161426; /* SelectorKey:ObjectType */
extern TNimType NTI5611; /* cint */
TNimType NTI161419; /* Event */
TNimType NTI161428; /* set[Event] */
extern TNimType NTI3213; /* RootRef */
TNimType NTI161421; /* SelectorKey */
extern TNimType NTI21801; /* ref ValueError */
extern TNimType NTI3249; /* ValueError */
extern TFrame* frameptr_16442;
extern tgcheap47416 gch_47444;
TNimType NTI161423; /* ReadyInfo */
TNimType NTI162136; /* seq[ReadyInfo] */
TNimType NTI161440; /* Selector:ObjectType */
extern TNimType NTI161446; /* Table */
TNimType NTI161439; /* Selector */
N_NIMCALL(void, TMP350)(void* p, NI op) {
	selectorkeyHEX3Aobjecttype161426* a;
	a = (selectorkeyHEX3Aobjecttype161426*)p;
	nimGCvisit((void*)(*a).Data, op);
}

static N_INLINE(void, nimFrame)(TFrame* s) {
	NI LOC1;
	LOC1 = 0;
	{
		if (!(frameptr_16442 == NIM_NIL)) goto LA4;
		LOC1 = 0;
	}
	goto LA2;
	LA4: ;
	{
		LOC1 = ((NI) ((NI16)((*frameptr_16442).calldepth + ((NI16) 1))));
	}
	LA2: ;
	(*s).calldepth = ((NI16) (LOC1));
	(*s).prev = frameptr_16442;
	frameptr_16442 = s;
	{
		if (!((*s).calldepth == ((NI16) 2000))) goto LA9;
		stackoverflow_19001();
	}
	LA9: ;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_16442 = (*frameptr_16442).prev;
}

static N_INLINE(tcell45335*, usrtocell_49046)(void* usr) {
	tcell45335* result;
	nimfr("usrToCell", "gc.nim")
	result = 0;
	nimln(118, "gc.nim");
	nimln(118, "gc.nim");
	nimln(118, "gc.nim");
	result = ((tcell45335*) ((NI)((NU64)(((NI) (usr))) - (NU64)(((NI)sizeof(tcell45335))))));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdzct_50604)(tcell45335* c) {
	nimfr("rtlAddZCT", "gc.nim")
	nimln(199, "gc.nim");
	addzct_49017((&gch_47444.Zct), c);
	popFrame();
}

static N_INLINE(void, nimGCunrefNoCycle)(void* p) {
	tcell45335* c;
	nimfr("nimGCunrefNoCycle", "gc.nim")
	nimln(233, "gc.nim");
	c = usrtocell_49046(p);
	nimln(235, "gc.nim");
	{
		nimln(167, "gc.nim");
		(*c).Refcount -= 8;
		nimln(168, "gc.nim");
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		nimln(236, "gc.nim");
		rtladdzct_50604(c);
	}
	LA3: ;
	popFrame();
}

static N_INLINE(NIM_BOOL, canbecycleroot_49067)(tcell45335* c) {
	NIM_BOOL result;
	nimfr("canbeCycleRoot", "gc.nim")
	result = 0;
	nimln(121, "gc.nim");
	nimln(121, "gc.nim");
	nimln(121, "gc.nim");
	result = !((((*(*c).Typ).flags &(1<<((((NU8) 1))&7)))!=0));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdcycleroot_49829)(tcell45335* c) {
	nimfr("rtlAddCycleRoot", "gc.nim")
	nimln(189, "gc.nim");
	{
		nimln(189, "gc.nim");
		nimln(189, "gc.nim");
		nimln(189, "gc.nim");
		if (!!((((NI) ((NI)((*c).Refcount & 3))) == 3))) goto LA3;
		nimln(139, "gc.nim");
		nimln(139, "gc.nim");
		nimln(139, "gc.nim");
		(*c).Refcount = (NI)((NI)((*c).Refcount & -4) | 3);
		nimln(191, "gc.nim");
		incl_46071((&gch_47444.Cycleroots), c);
	}
	LA3: ;
	popFrame();
}

static N_INLINE(void, incref_51425)(tcell45335* c) {
	nimfr("incRef", "gc.nim")
	nimln(216, "gc.nim");
	nimln(216, "gc.nim");
	(*c).Refcount = (NI)((NU64)((*c).Refcount) + (NU64)(8));
	nimln(219, "gc.nim");
	{
		NIM_BOOL LOC3;
		nimln(219, "gc.nim");
		LOC3 = 0;
		LOC3 = canbecycleroot_49067(c);
		if (!LOC3) goto LA4;
		nimln(220, "gc.nim");
		rtladdcycleroot_49829(c);
	}
	LA4: ;
	popFrame();
}

static N_INLINE(void, decref_51004)(tcell45335* c) {
	nimfr("decRef", "gc.nim")
	nimln(206, "gc.nim");
	{
		nimln(167, "gc.nim");
		(*c).Refcount -= 8;
		nimln(168, "gc.nim");
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		nimln(207, "gc.nim");
		rtladdzct_50604(c);
	}
	goto LA1;
	LA3: ;
	{
		NIM_BOOL LOC6;
		nimln(208, "gc.nim");
		LOC6 = 0;
		LOC6 = canbecycleroot_49067(c);
		if (!LOC6) goto LA7;
		nimln(211, "gc.nim");
		rtladdcycleroot_49829(c);
	}
	goto LA1;
	LA7: ;
	LA1: ;
	popFrame();
}

static N_INLINE(void, asgnRef)(void** dest, void* src) {
	nimfr("asgnRef", "gc.nim")
	nimln(244, "gc.nim");
	{
		tcell45335* LOC5;
		nimln(244, "gc.nim");
		nimln(244, "gc.nim");
		if (!!((src == NIM_NIL))) goto LA3;
		nimln(244, "gc.nim");
		nimln(244, "gc.nim");
		LOC5 = 0;
		LOC5 = usrtocell_49046(src);
		incref_51425(LOC5);
	}
	LA3: ;
	nimln(245, "gc.nim");
	{
		tcell45335* LOC10;
		nimln(245, "gc.nim");
		nimln(245, "gc.nim");
		if (!!(((*dest) == NIM_NIL))) goto LA8;
		nimln(245, "gc.nim");
		nimln(245, "gc.nim");
		LOC10 = 0;
		LOC10 = usrtocell_49046((*dest));
		decref_51004(LOC10);
	}
	LA8: ;
	nimln(246, "gc.nim");
	(*dest) = src;
	popFrame();
}

N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, register_161466)(selectorHEX3Aobjecttype161440* s, int fd, NU8 events, TNimObject* data) {
	selectorkeyHEX3Aobjecttype161426* result;
	selectorkeyHEX3Aobjecttype161426* sk;
	selectorkeyHEX3Aobjecttype161426* LOC7;
	nimfr("register", "selectors.nim")
	result = 0;
	nimln(194, "selectors.nim");
	{
		NIM_BOOL LOC3;
		valueerror3249* e_161537;
		NimStringDesc* LOC6;
		nimln(194, "selectors.nim");
		LOC3 = 0;
		LOC3 = haskey_161476((*s).Fds, fd);
		if (!LOC3) goto LA4;
		e_161537 = 0;
		nimln(2149, "system.nim");
		e_161537 = (valueerror3249*) newObj((&NTI21801), sizeof(valueerror3249));
		(*e_161537).Sup.Sup.m_type = (&NTI3249);
		nimln(2150, "system.nim");
		LOC6 = 0;
		LOC6 = (*e_161537).Sup.message; (*e_161537).Sup.message = copyStringRC1(((NimStringDesc*) &TMP353));
		if (LOC6) nimGCunrefNoCycle(LOC6);
		nimln(195, "selectors.nim");
		raiseException((Exception*)e_161537, "ValueError");
	}
	LA4: ;
	nimln(196, "selectors.nim");
	LOC7 = 0;
	LOC7 = (selectorkeyHEX3Aobjecttype161426*) newObj((&NTI161421), sizeof(selectorkeyHEX3Aobjecttype161426));
	(*LOC7).Fd = fd;
	(*LOC7).Events = events;
	asgnRef((void**) (&(*LOC7).Data), data);
	sk = LOC7;
	nimln(197, "selectors.nim");
	HEX5BHEX5DHEX3D_161559((&(*s).Fds), fd, sk);
	nimln(198, "selectors.nim");
	result = sk;
	popFrame();
	return result;
}

N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, update_161806)(selectorHEX3Aobjecttype161440* s, int fd, NU8 events) {
	selectorkeyHEX3Aobjecttype161426* result;
	selectorkeyHEX3Aobjecttype161426* LOC7;
	nimfr("update", "selectors.nim")
	result = 0;
	nimln(203, "selectors.nim");
	{
		NIM_BOOL LOC3;
		valueerror3249* e_161829;
		NimStringDesc* LOC6;
		nimln(203, "selectors.nim");
		nimln(203, "selectors.nim");
		LOC3 = 0;
		LOC3 = haskey_161476((*s).Fds, fd);
		if (!!(LOC3)) goto LA4;
		e_161829 = 0;
		nimln(2149, "system.nim");
		e_161829 = (valueerror3249*) newObj((&NTI21801), sizeof(valueerror3249));
		(*e_161829).Sup.Sup.m_type = (&NTI3249);
		nimln(2150, "system.nim");
		LOC6 = 0;
		LOC6 = (*e_161829).Sup.message; (*e_161829).Sup.message = copyStringRC1(((NimStringDesc*) &TMP354));
		if (LOC6) nimGCunrefNoCycle(LOC6);
		nimln(204, "selectors.nim");
		raiseException((Exception*)e_161829, "ValueError");
	}
	LA4: ;
	nimln(206, "selectors.nim");
	nimln(206, "selectors.nim");
	LOC7 = 0;
	LOC7 = HEX5BHEX5D_161849((*s).Fds, fd);
	(*LOC7).Events = events;
	nimln(207, "selectors.nim");
	result = HEX5BHEX5D_161849((*s).Fds, fd);
	popFrame();
	return result;
}

N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, unregister_161897)(selectorHEX3Aobjecttype161440* s, int fd) {
	selectorkeyHEX3Aobjecttype161426* result;
	nimfr("unregister", "selectors.nim")
	result = 0;
	nimln(210, "selectors.nim");
	result = HEX5BHEX5D_161849((*s).Fds, fd);
	nimln(211, "selectors.nim");
	del_161919((&(*s).Fds), fd);
	popFrame();
	return result;
}

N_NIMCALL(void, close_161967)(selectorHEX3Aobjecttype161440* s) {
	nimfr("close", "selectors.nim")
	popFrame();
}

static N_INLINE(NI, divInt)(NI a, NI b) {
	NI result;
	result = 0;
	{
		if (!(b == 0)) goto LA3;
		raiseDivByZero();
	}
	LA3: ;
	{
		NIM_BOOL LOC7;
		LOC7 = 0;
		LOC7 = (a == (IL64(-9223372036854775807) - IL64(1)));
		if (!(LOC7)) goto LA8;
		LOC7 = (b == -1);
		LA8: ;
		if (!LOC7) goto LA9;
		raiseOverflow();
	}
	LA9: ;
	result = (NI64)(a / b);
	goto BeforeRet;
	BeforeRet: ;
	return result;
}

static N_INLINE(NI, chckRange)(NI i, NI a, NI b) {
	NI result;
	result = 0;
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (a <= i);
		if (!(LOC3)) goto LA4;
		LOC3 = (i <= b);
		LA4: ;
		if (!LOC3) goto LA5;
		result = i;
		goto BeforeRet;
	}
	goto LA1;
	LA5: ;
	{
		raiseRangeError(((NI64) (i)));
	}
	LA1: ;
	BeforeRet: ;
	return result;
}

static N_INLINE(NI, subInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU64)(a) - (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ (NI)((NU64) ~(b))));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

N_NIMCALL(struct timeval, timevalfrommilliseconds_161973)(NI timeout) {
	struct timeval result;
	nimfr("timeValFromMilliseconds", "selectors.nim")
	memset((void*)(&result), 0, sizeof(result));
	nimln(216, "selectors.nim");
	{
		NI seconds;
		NI TMP355;
		NI TMP356;
		NI TMP357;
		NI TMP358;
		nimln(216, "selectors.nim");
		nimln(216, "selectors.nim");
		if (!!((timeout == -1))) goto LA3;
		nimln(217, "selectors.nim");
		nimln(217, "selectors.nim");
		TMP355 = divInt(timeout, 1000);
		seconds = (NI64)(TMP355);
		nimln(218, "selectors.nim");
		result.tv_sec = ((NI) (((NI32)chckRange(seconds, ((NI32) (-2147483647 -1)), ((NI32) 2147483647)))));
		nimln(219, "selectors.nim");
		nimln(219, "selectors.nim");
		nimln(219, "selectors.nim");
		nimln(219, "selectors.nim");
		TMP356 = mulInt(seconds, 1000);
		TMP357 = subInt(timeout, (NI64)(TMP356));
		TMP358 = mulInt((NI64)(TMP357), 1000);
		result.tv_usec = ((NI) (((NI32)chckRange((NI64)(TMP358), ((NI32) (-2147483647 -1)), ((NI32) 2147483647)))));
	}
	LA3: ;
	popFrame();
	return result;
}

static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU64)(a) + (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

N_NIMCALL(void, createfdset_161984)(fd_set* rd, fd_set* wr, table161446 fds, NI* m) {
	nimfr("createFdSet", "selectors.nim")
	nimln(223, "selectors.nim");
	FD_ZERO(rd);
	nimln(223, "selectors.nim");
	FD_ZERO(wr);
	{
		int k_162051;
		selectorkeyHEX3Aobjecttype161426* v_162052;
		k_162051 = 0;
		v_162052 = 0;
		{
			NI h_162107;
			NI HEX3Atmp_162109;
			NI res_162111;
			h_162107 = 0;
			HEX3Atmp_162109 = 0;
			nimln(92, "tables.nim");
			nimln(92, "tables.nim");
			HEX3Atmp_162109 = (fds.Data->Sup.len-1);
			nimln(1576, "system.nim");
			res_162111 = 0;
			{
				nimln(1577, "system.nim");
				while (1) {
					nimln(1577, "system.nim");
					if (!(res_162111 <= HEX3Atmp_162109)) goto LA4;
					nimln(1576, "system.nim");
					h_162107 = res_162111;
					nimln(93, "tables.nim");
					{
						nimln(93, "tables.nim");
						if ((NU)(h_162107) >= (NU)(fds.Data->Sup.len)) raiseIndexError();
						if (!(fds.Data->data[h_162107].Field0 == ((NU8) 1))) goto LA7;
						nimln(93, "tables.nim");
						if ((NU)(h_162107) >= (NU)(fds.Data->Sup.len)) raiseIndexError();
						k_162051 = fds.Data->data[h_162107].Field1;
						nimln(93, "tables.nim");
						if ((NU)(h_162107) >= (NU)(fds.Data->Sup.len)) raiseIndexError();
						v_162052 = fds.Data->data[h_162107].Field2;
						nimln(225, "selectors.nim");
						{
							nimln(225, "selectors.nim");
							if (!(((*v_162052).Events &(1<<((((NU8) 0))&7)))!=0)) goto LA11;
							nimln(226, "selectors.nim");
							nimln(226, "selectors.nim");
							(*m) = (((*m) >= ((NI) (k_162051))) ? (*m) : ((NI) (k_162051)));
							nimln(227, "selectors.nim");
							FD_SET(k_162051, rd);
						}
						LA11: ;
						nimln(228, "selectors.nim");
						{
							nimln(228, "selectors.nim");
							if (!(((*v_162052).Events &(1<<((((NU8) 1))&7)))!=0)) goto LA15;
							nimln(229, "selectors.nim");
							nimln(229, "selectors.nim");
							(*m) = (((*m) >= ((NI) (k_162051))) ? (*m) : ((NI) (k_162051)));
							nimln(230, "selectors.nim");
							FD_SET(k_162051, wr);
						}
						LA15: ;
					}
					LA7: ;
					nimln(1579, "system.nim");
					res_162111 = addInt(res_162111, 1);
				} LA4: ;
			}
		}
	}
	popFrame();
}
N_NIMCALL(void, TMP360)(void* p, NI op) {
	TY162136* a;
	NI LOC1;
	a = (TY162136*)p;
	LOC1 = 0;
	for (LOC1 = 0; LOC1 < a->Sup.len; LOC1++) {
	nimGCvisit((void*)a->data[LOC1].Field0, op);
	}
}

N_NIMCALL(TY162136*, getreadyfds_162127)(fd_set* rd, fd_set* wr, table161446 fds) {
	TY162136* result;
	nimfr("getReadyFDs", "selectors.nim")
	result = 0;
	nimln(234, "selectors.nim");
	result = (TY162136*) newSeq((&NTI162136), 0);
	{
		int k_162175;
		selectorkeyHEX3Aobjecttype161426* v_162176;
		k_162175 = 0;
		v_162176 = 0;
		{
			NI h_162259;
			NI HEX3Atmp_162261;
			NI res_162263;
			h_162259 = 0;
			HEX3Atmp_162261 = 0;
			nimln(92, "tables.nim");
			nimln(92, "tables.nim");
			HEX3Atmp_162261 = (fds.Data->Sup.len-1);
			nimln(1576, "system.nim");
			res_162263 = 0;
			{
				nimln(1577, "system.nim");
				while (1) {
					nimln(1577, "system.nim");
					if (!(res_162263 <= HEX3Atmp_162261)) goto LA4;
					nimln(1576, "system.nim");
					h_162259 = res_162263;
					nimln(93, "tables.nim");
					{
						NU8 events;
						readyinfo161423 LOC19;
						nimln(93, "tables.nim");
						if ((NU)(h_162259) >= (NU)(fds.Data->Sup.len)) raiseIndexError();
						if (!(fds.Data->data[h_162259].Field0 == ((NU8) 1))) goto LA7;
						nimln(93, "tables.nim");
						if ((NU)(h_162259) >= (NU)(fds.Data->Sup.len)) raiseIndexError();
						k_162175 = fds.Data->data[h_162259].Field1;
						nimln(93, "tables.nim");
						if ((NU)(h_162259) >= (NU)(fds.Data->Sup.len)) raiseIndexError();
						v_162176 = fds.Data->data[h_162259].Field2;
						nimln(236, "selectors.nim");
						events = 0;
						nimln(237, "selectors.nim");
						{
							int LOC11;
							nimln(237, "selectors.nim");
							nimln(237, "selectors.nim");
							nimln(237, "selectors.nim");
							LOC11 = 0;
							LOC11 = FD_ISSET(k_162175, rd);
							if (!!((LOC11 == ((NI32) 0)))) goto LA12;
							nimln(238, "selectors.nim");
							nimln(238, "selectors.nim");
							events = (events | 1);
						}
						LA12: ;
						nimln(239, "selectors.nim");
						{
							int LOC16;
							nimln(239, "selectors.nim");
							nimln(239, "selectors.nim");
							nimln(239, "selectors.nim");
							LOC16 = 0;
							LOC16 = FD_ISSET(k_162175, wr);
							if (!!((LOC16 == ((NI32) 0)))) goto LA17;
							nimln(240, "selectors.nim");
							nimln(240, "selectors.nim");
							events = (events | 2);
						}
						LA17: ;
						nimln(241, "selectors.nim");
						memset((void*)(&LOC19), 0, sizeof(LOC19));
						LOC19.Field0 = v_162176;
						LOC19.Field1 = events;
						result = (TY162136*) incrSeq(&(result)->Sup, sizeof(readyinfo161423));
						asgnRef((void**) (&result->data[result->Sup.len-1].Field0), LOC19.Field0);
						result->data[result->Sup.len-1].Field1 = LOC19.Field1;
					}
					LA7: ;
					nimln(1579, "system.nim");
					res_162263 = addInt(res_162263, 1);
				} LA4: ;
			}
		}
	}
	popFrame();
	return result;
}

N_NIMCALL(TY162136*, select_162279)(table161446 fds, NI timeout) {
	TY162136* result;
	struct timeval tv;
	fd_set rd;
	fd_set wr;
	NI m;
	NI retcode;
	nimfr("select", "selectors.nim")
	result = 0;
	nimln(245, "selectors.nim");
	tv = timevalfrommilliseconds_161973(timeout);
	memset((void*)(&rd), 0, sizeof(rd));
	memset((void*)(&wr), 0, sizeof(wr));
	nimln(248, "selectors.nim");
	m = 0;
	nimln(249, "selectors.nim");
	createfdset_161984((&rd), (&wr), fds, (&m));
	nimln(251, "selectors.nim");
	retcode = 0;
	nimln(252, "selectors.nim");
	{
		NI TMP361;
		int LOC5;
		nimln(252, "selectors.nim");
		nimln(252, "selectors.nim");
		if (!!((timeout == -1))) goto LA3;
		nimln(253, "selectors.nim");
		nimln(253, "selectors.nim");
		nimln(253, "selectors.nim");
		TMP361 = addInt(m, 1);
		LOC5 = 0;
		LOC5 = select(((int)chckRange((NI64)(TMP361), ((int) (-2147483647 -1)), ((int) 2147483647))), (&rd), (&wr), NIM_NIL, (&tv));
		retcode = ((NI) (LOC5));
	}
	goto LA1;
	LA3: ;
	{
		NI TMP362;
		int LOC7;
		nimln(255, "selectors.nim");
		nimln(255, "selectors.nim");
		nimln(255, "selectors.nim");
		TMP362 = addInt(m, 1);
		LOC7 = 0;
		LOC7 = select(((int)chckRange((NI64)(TMP362), ((int) (-2147483647 -1)), ((int) 2147483647))), (&rd), (&wr), NIM_NIL, NIM_NIL);
		retcode = ((NI) (LOC7));
	}
	LA1: ;
	nimln(257, "selectors.nim");
	{
		NI32 LOC12;
		nimln(257, "selectors.nim");
		if (!(retcode < 0)) goto LA10;
		nimln(258, "selectors.nim");
		nimln(258, "selectors.nim");
		LOC12 = 0;
		LOC12 = oslasterror_123041();
		raiseoserror_123009(LOC12);
	}
	goto LA8;
	LA10: ;
	{
		nimln(259, "selectors.nim");
		if (!(retcode == 0)) goto LA14;
		nimln(260, "selectors.nim");
		nimln(260, "selectors.nim");
		result = (TY162136*) newSeq((&NTI162136), 0);
		goto BeforeRet;
	}
	goto LA8;
	LA14: ;
	{
		nimln(262, "selectors.nim");
		nimln(262, "selectors.nim");
		result = getreadyfds_162127((&rd), (&wr), fds);
		goto BeforeRet;
	}
	LA8: ;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(TY162136*, select_162365)(selectorHEX3Aobjecttype161440* s, NI timeout) {
	TY162136* result;
	nimfr("select", "selectors.nim")
	result = 0;
	nimln(265, "selectors.nim");
	result = select_162279((*s).Fds, timeout);
	popFrame();
	return result;
}
N_NIMCALL(void, TMP364)(void* p, NI op) {
	selectorHEX3Aobjecttype161440* a;
	a = (selectorHEX3Aobjecttype161440*)p;
	nimGCvisit((void*)(*a).Fds.Data, op);
}

N_NIMCALL(selectorHEX3Aobjecttype161440*, newselector_162375)(void) {
	selectorHEX3Aobjecttype161440* result;
	nimfr("newSelector", "selectors.nim")
	result = 0;
	nimln(268, "selectors.nim");
	result = (selectorHEX3Aobjecttype161440*) newObj((&NTI161439), sizeof(selectorHEX3Aobjecttype161440));
	nimln(269, "selectors.nim");
	inittable_162395(64, (&(*result).Fds));
	popFrame();
	return result;
}

N_NIMCALL(NIM_BOOL, contains_162624)(selectorHEX3Aobjecttype161440* s, int fd) {
	NIM_BOOL result;
	nimfr("contains", "selectors.nim")
	result = 0;
	nimln(272, "selectors.nim");
	nimln(272, "selectors.nim");
	result = haskey_161476((*s).Fds, fd);
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(selectorkeyHEX3Aobjecttype161426*, HEX5BHEX5D_162646)(selectorHEX3Aobjecttype161440* s, int fd) {
	selectorkeyHEX3Aobjecttype161426* result;
	nimfr("[]", "selectors.nim")
	result = 0;
	nimln(275, "selectors.nim");
	nimln(275, "selectors.nim");
	result = HEX5BHEX5D_161849((*s).Fds, fd);
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(NIM_BOOL, contains_162804)(selectorHEX3Aobjecttype161440* s, selectorkeyHEX3Aobjecttype161426* key) {
	NIM_BOOL result;
	NIM_BOOL LOC1;
	selectorkeyHEX3Aobjecttype161426* LOC3;
	nimfr("contains", "selectors.nim")
	result = 0;
	nimln(283, "selectors.nim");
	nimln(283, "selectors.nim");
	nimln(283, "selectors.nim");
	LOC1 = 0;
	nimln(283, "selectors.nim");
	LOC1 = contains_162624(s, (*key).Fd);
	if (!(LOC1)) goto LA2;
	nimln(283, "selectors.nim");
	nimln(283, "selectors.nim");
	LOC3 = 0;
	LOC3 = HEX5BHEX5D_161849((*s).Fds, (*key).Fd);
	LOC1 = (LOC3 == key);
	LA2: ;
	result = LOC1;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}
NIM_EXTERNC N_NOINLINE(void, stdlib_selectorsInit)(void) {
	nimfr("selectors", "selectors.nim")
	popFrame();
}

NIM_EXTERNC N_NOINLINE(void, stdlib_selectorsDatInit)(void) {
static TNimNode* TMP345[3];
static TNimNode* TMP346[2];
NI TMP348;
static char* NIM_CONST TMP347[2] = {
"EvRead", 
"EvWrite"};
static TNimNode* TMP359[2];
static TNimNode TMP338[12];
NTI161426.size = sizeof(selectorkeyHEX3Aobjecttype161426);
NTI161426.kind = 18;
NTI161426.base = 0;
TMP345[0] = &TMP338[1];
TMP338[1].kind = 1;
TMP338[1].offset = offsetof(selectorkeyHEX3Aobjecttype161426, Fd);
TMP338[1].typ = (&NTI5611);
TMP338[1].name = "fd";
TMP345[1] = &TMP338[2];
NTI161419.size = sizeof(NU8);
NTI161419.kind = 14;
NTI161419.base = 0;
NTI161419.flags = 3;
for (TMP348 = 0; TMP348 < 2; TMP348++) {
TMP338[TMP348+3].kind = 1;
TMP338[TMP348+3].offset = TMP348;
TMP338[TMP348+3].name = TMP347[TMP348];
TMP346[TMP348] = &TMP338[TMP348+3];
}
TMP338[5].len = 2; TMP338[5].kind = 2; TMP338[5].sons = &TMP346[0];
NTI161419.node = &TMP338[5];
NTI161428.size = sizeof(NU8);
NTI161428.kind = 19;
NTI161428.base = (&NTI161419);
NTI161428.flags = 3;
TMP338[6].len = 0; TMP338[6].kind = 0;
NTI161428.node = &TMP338[6];
TMP338[2].kind = 1;
TMP338[2].offset = offsetof(selectorkeyHEX3Aobjecttype161426, Events);
TMP338[2].typ = (&NTI161428);
TMP338[2].name = "events";
TMP345[2] = &TMP338[7];
TMP338[7].kind = 1;
TMP338[7].offset = offsetof(selectorkeyHEX3Aobjecttype161426, Data);
TMP338[7].typ = (&NTI3213);
TMP338[7].name = "data";
TMP338[0].len = 3; TMP338[0].kind = 2; TMP338[0].sons = &TMP345[0];
NTI161426.node = &TMP338[0];
NTI161421.size = sizeof(selectorkeyHEX3Aobjecttype161426*);
NTI161421.kind = 22;
NTI161421.base = (&NTI161426);
NTI161421.marker = TMP350;
NTI161423.size = sizeof(readyinfo161423);
NTI161423.kind = 18;
NTI161423.base = 0;
TMP359[0] = &TMP338[9];
TMP338[9].kind = 1;
TMP338[9].offset = offsetof(readyinfo161423, Field0);
TMP338[9].typ = (&NTI161421);
TMP338[9].name = "Field0";
TMP359[1] = &TMP338[10];
TMP338[10].kind = 1;
TMP338[10].offset = offsetof(readyinfo161423, Field1);
TMP338[10].typ = (&NTI161428);
TMP338[10].name = "Field1";
TMP338[8].len = 2; TMP338[8].kind = 2; TMP338[8].sons = &TMP359[0];
NTI161423.node = &TMP338[8];
NTI162136.size = sizeof(TY162136*);
NTI162136.kind = 24;
NTI162136.base = (&NTI161423);
NTI162136.marker = TMP360;
NTI161440.size = sizeof(selectorHEX3Aobjecttype161440);
NTI161440.kind = 18;
NTI161440.base = 0;
TMP338[11].kind = 1;
TMP338[11].offset = offsetof(selectorHEX3Aobjecttype161440, Fds);
TMP338[11].typ = (&NTI161446);
TMP338[11].name = "fds";
NTI161440.node = &TMP338[11];
NTI161439.size = sizeof(selectorHEX3Aobjecttype161440*);
NTI161439.kind = 22;
NTI161439.base = (&NTI161440);
NTI161439.marker = TMP364;
}


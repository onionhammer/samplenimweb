/* Generated by Nim Compiler v0.10.2 */
/*   (c) 2014 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: MacOSX, amd64, clang */
/* Command for C compiler:
   clang -c  -w  -I/Users/erikoleary/lib/Nim/lib -o /Users/erikoleary/Documents/onion-nimrod/sampleweb/nimcache/stdlib_asynchttpserver.o /Users/erikoleary/Documents/onion-nimrod/sampleweb/nimcache/stdlib_asynchttpserver.c */
#define NIM_INTBITS 64
#include "nimbase.h"

#include <string.h>

#include <setjmp.h>

#include <sys/socket.h>
typedef struct TY185074 TY185074;
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct asynchttpserverHEX3Aobjecttype185023 asynchttpserverHEX3Aobjecttype185023;
typedef struct asyncsocketdesc175202 asyncsocketdesc175202;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct stringtableobj173012 stringtableobj173012;
typedef struct TNimObject TNimObject;
typedef struct keyvaluepairseq173010 keyvaluepairseq173010;
typedef struct TY109352 TY109352;
typedef struct futureHEX3Aobjecttype160094 futureHEX3Aobjecttype160094;
typedef struct request185005 request185005;
typedef struct uri184012 uri184012;
typedef struct TY185414 TY185414;
typedef struct futurebaseHEX3Aobjecttype160014 futurebaseHEX3Aobjecttype160014;
typedef struct tcell45335 tcell45335;
typedef struct tcellset45347 tcellset45347;
typedef struct tgcheap47416 tgcheap47416;
typedef struct tcellseq45351 tcellseq45351;
typedef struct tpagedesc45343 tpagedesc45343;
typedef struct tmemregion27610 tmemregion27610;
typedef struct tsmallchunk26840 tsmallchunk26840;
typedef struct tllchunk27604 tllchunk27604;
typedef struct tbigchunk26842 tbigchunk26842;
typedef struct tintset26817 tintset26817;
typedef struct ttrunk26813 ttrunk26813;
typedef struct tavlnode27608 tavlnode27608;
typedef struct tgcstat47414 tgcstat47414;
typedef struct Exception Exception;
typedef struct TSafePoint TSafePoint;
typedef struct valueerror3249 valueerror3249;
typedef struct TY186214 TY186214;
typedef struct futureHEX3Aobjecttype165748 futureHEX3Aobjecttype165748;
typedef struct TY13406 TY13406;
typedef struct TY161264 TY161264;
typedef struct TY161267 TY161267;
typedef struct TY186414 TY186414;
typedef struct futureHEX3Aobjecttype179452 futureHEX3Aobjecttype179452;
typedef struct TY179445 TY179445;
typedef struct tbasechunk26838 tbasechunk26838;
typedef struct tfreecell26830 tfreecell26830;
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
struct TY185074 {
NimStringDesc* Field0;
NI Field1;
NI Field2;
};
struct  asynchttpserverHEX3Aobjecttype185023  {
asyncsocketdesc175202* Socket;
NIM_BOOL Reuseaddr;
};
typedef N_NIMCALL_PTR(void, TY3089) (void* p, NI op);
typedef N_NIMCALL_PTR(void*, TY3094) (void* p);
struct  TNimType  {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY3089 marker;
TY3094 deepcopy;
};
struct  TNimNode  {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct  TNimObject  {
TNimType* m_type;
};
struct TY109352 {
NimStringDesc* Field0;
NimStringDesc* Field1;
};
struct  stringtableobj173012  {
  TNimObject Sup;
NI Counter;
keyvaluepairseq173010* Data;
NU8 Mode;
};
struct  uri184012  {
NimStringDesc* Scheme;
NimStringDesc* Username;
NimStringDesc* Password;
NimStringDesc* Hostname;
NimStringDesc* Port;
NimStringDesc* Path;
NimStringDesc* Query;
NimStringDesc* Anchor;
};
struct  request185005  {
asyncsocketdesc175202* Client;
NimStringDesc* Reqmethod;
stringtableobj173012* Headers;
TY185074 Protocol;
uri184012 Url;
NimStringDesc* Hostname;
NimStringDesc* Body;
};
typedef struct {
N_NIMCALL_PTR(futurebaseHEX3Aobjecttype160014*, ClPrc) (void* ClEnv);
void* ClEnv;
} TY170666;
struct  TY185414  {
NI HEX3Astate;
stringtableobj173012* Headers185183;
NimStringDesc* Content185172;
NU8 Code185171;
request185005 Req185170;
futureHEX3Aobjecttype160094* Retfuture185165;
TY170666 Nameitervar185220;
stringtableobj173012* Customheaders185197;
NimStringDesc* Msg185205;
futureHEX3Aobjecttype160094* Future185167;
};
struct  tcell45335  {
NI Refcount;
TNimType* Typ;
};
struct  tcellseq45351  {
NI Len;
NI Cap;
tcell45335** D;
};
struct  tcellset45347  {
NI Counter;
NI Max;
tpagedesc45343* Head;
tpagedesc45343** Data;
};
typedef tsmallchunk26840* TY27622[512];
typedef ttrunk26813* ttrunkbuckets26815[256];
struct  tintset26817  {
ttrunkbuckets26815 Data;
};
struct  tmemregion27610  {
NI Minlargeobj;
NI Maxlargeobj;
TY27622 Freesmallchunks;
tllchunk27604* Llmem;
NI Currmem;
NI Maxmem;
NI Freemem;
NI Lastsize;
tbigchunk26842* Freechunkslist;
tintset26817 Chunkstarts;
tavlnode27608* Root;
tavlnode27608* Deleted;
tavlnode27608* Last;
tavlnode27608* Freeavlnodes;
};
struct  tgcstat47414  {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
NI64 Maxpause;
};
struct  tgcheap47416  {
void* Stackbottom;
NI Cyclethreshold;
tcellseq45351 Zct;
tcellseq45351 Decstack;
tcellset45347 Cycleroots;
tcellseq45351 Tempstack;
NI Recgclock;
tmemregion27610 Region;
tgcstat47414 Stat;
};
struct  Exception  {
  TNimObject Sup;
Exception* parent;
NCSTRING name;
NimStringDesc* message;
NimStringDesc* trace;
};
typedef struct {
N_NIMCALL_PTR(NIM_BOOL, ClPrc) (Exception* e, void* ClEnv);
void* ClEnv;
} TY15009;
struct  TSafePoint  {
TSafePoint* prev;
NI status;
jmp_buf context;
NIM_BOOL hasRaiseAction;
TY15009 raiseAction;
};
typedef N_CLOSURE_PTR(futurebaseHEX3Aobjecttype160014*, TMP617) (void);
typedef struct {
N_NIMCALL_PTR(void, ClPrc) (void* ClEnv);
void* ClEnv;
} TY160015;
struct  futurebaseHEX3Aobjecttype160014  {
  TNimObject Sup;
TY160015 Cb;
NIM_BOOL Finished;
Exception* Error;
NimStringDesc* Errorstacktrace;
NimStringDesc* Stacktrace;
NI Id;
NimStringDesc* Fromproc;
};
struct  futureHEX3Aobjecttype160094  {
  futurebaseHEX3Aobjecttype160014 Sup;
};
typedef N_CLOSURE_PTR(void, TMP619) (void);
typedef NU8 TY76268[32];
struct  valueerror3249  {
  Exception Sup;
};
typedef struct {
N_NIMCALL_PTR(futureHEX3Aobjecttype160094*, ClPrc) (request185005* request, void* ClEnv);
void* ClEnv;
} TY185607;
struct  TY186214  {
NI HEX3Astate;
asyncsocketdesc175202* Client185605;
NimStringDesc* Address185606;
futureHEX3Aobjecttype160094* Retfuture185591;
TY185607 Callback185612;
TY170666 Nameitervar186037;
request185005 Request185626;
futureHEX3Aobjecttype165748* Future185593;
NimStringDesc* Line185829;
TY13406* Lineparts185832;
futureHEX3Aobjecttype160094* Future185594;
NimStringDesc* Reqmethod185854;
NimStringDesc* Path185855;
NimStringDesc* Protocol185856;
NI I185857;
futureHEX3Aobjecttype165748* Future185595;
NimStringDesc* Headerline185869;
TY109352 Kv185872;
futureHEX3Aobjecttype160094* Future185596;
futureHEX3Aobjecttype160094* Future185597;
NI Contentlength185927;
futureHEX3Aobjecttype160094* Future185598;
futureHEX3Aobjecttype165748* Future185599;
futureHEX3Aobjecttype160094* Future185600;
futureHEX3Aobjecttype160094* Future185601;
futureHEX3Aobjecttype160094* Future185602;
};
struct TY161264 {
void* Field0;
TY161267* Field1;
};
typedef TY109352 TY185182[1];
typedef N_CLOSURE_PTR(futureHEX3Aobjecttype160094*, TMP666) (request185005* request);
typedef N_CLOSURE_PTR(futurebaseHEX3Aobjecttype160014*, TMP672) (void);
typedef N_CLOSURE_PTR(void, TMP674) (void);
struct TY179445 {
NimStringDesc* Field0;
asyncsocketdesc175202* Field1;
};
struct  TY186414  {
NI HEX3Astate;
asynchttpserverHEX3Aobjecttype185023* Server186266;
NU16 Port186267;
NimStringDesc* Address186274;
TY185607 Callback186273;
futureHEX3Aobjecttype160094* Retfuture186261;
TY170666 Nameitervar186314;
futureHEX3Aobjecttype179452* Future186263;
TY179445 Fut186299;
};
typedef N_CLOSURE_PTR(futurebaseHEX3Aobjecttype160014*, TMP679) (void);
typedef N_CLOSURE_PTR(void, TMP681) (void);
typedef NIM_CHAR TY175208[4001];
struct  asyncsocketdesc175202  {
int Fd;
NIM_BOOL Closed;
NIM_BOOL Isbuffered;
union {
struct {TY175208 Buffer;
NI Currpos;
NI Buflen;
} S1;
} isbufferedU;
NIM_BOOL Isssl;
union {
} issslU;
};
typedef NI TY26820[8];
struct  tpagedesc45343  {
tpagedesc45343* Next;
NI Key;
TY26820 Bits;
};
struct  tbasechunk26838  {
NI Prevsize;
NI Size;
NIM_BOOL Used;
};
struct  tsmallchunk26840  {
  tbasechunk26838 Sup;
tsmallchunk26840* Next;
tsmallchunk26840* Prev;
tfreecell26830* Freelist;
NI Free;
NI Acc;
NF Data;
};
struct  tllchunk27604  {
NI Size;
NI Acc;
tllchunk27604* Next;
};
struct  tbigchunk26842  {
  tbasechunk26838 Sup;
tbigchunk26842* Next;
tbigchunk26842* Prev;
NI Align;
NF Data;
};
struct  ttrunk26813  {
ttrunk26813* Next;
NI Key;
TY26820 Bits;
};
typedef tavlnode27608* TY27614[2];
struct  tavlnode27608  {
TY27614 Link;
NI Key;
NI Upperbound;
NI Level;
};
struct  futureHEX3Aobjecttype165748  {
  futurebaseHEX3Aobjecttype160014 Sup;
NimStringDesc* Value;
};
struct TY161267 {
char dummy;
};
struct  futureHEX3Aobjecttype179452  {
  futurebaseHEX3Aobjecttype160014 Sup;
TY179445 Value;
};
struct  tfreecell26830  {
tfreecell26830* Next;
NI Zerofield;
};
struct keyvaluepairseq173010 {
  TGenericSeq Sup;
  TY109352 data[SEQ_DECL_SIZE];
};
struct TY13406 {
  TGenericSeq Sup;
  NimStringDesc* data[SEQ_DECL_SIZE];
};
N_NIMCALL(NIM_BOOL, HEX3DHEX3D_185072)(TY185074* protocol, NU8 ver);
static N_INLINE(void, nimFrame)(TFrame* s);
N_NOINLINE(void, stackoverflow_19001)(void);
static N_INLINE(void, popFrame)(void);
N_NIMCALL(asynchttpserverHEX3Aobjecttype185023*, newasynchttpserver_185089)(NIM_BOOL reuseaddr);
N_NIMCALL(void, nimGCvisit)(void* d, NI op);
N_NIMCALL(void, TMP602)(void* p, NI op);
N_NIMCALL(void*, newObj)(TNimType* typ, NI size);
N_NIMCALL(void, addheaders_185115)(NimStringDesc** msg, stringtableobj173012* headers);
N_NOINLINE(void, raiseIndexError)(void);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* dest, NI addlen);
static N_INLINE(NI, addInt)(NI a, NI b);
N_NOINLINE(void, raiseOverflow)(void);
N_NIMCALL(futureHEX3Aobjecttype160094*, sendheaders_185149)(request185005* req, stringtableobj173012* headers);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
N_NIMCALL(futureHEX3Aobjecttype160094*, send_178851)(asyncsocketdesc175202* socket, NimStringDesc* data, NU8 flags);
N_NIMCALL(futureHEX3Aobjecttype160094*, respond_185168)(request185005* req, NU8 code, NimStringDesc* content, stringtableobj173012* headers);
N_NIMCALL(void, TMP612)(void* p, NI op);
static N_INLINE(void, asgnRef)(void** dest, void* src);
static N_INLINE(void, incref_51425)(tcell45335* c);
static N_INLINE(NIM_BOOL, canbecycleroot_49067)(tcell45335* c);
static N_INLINE(void, rtladdcycleroot_49829)(tcell45335* c);
N_NOINLINE(void, incl_46071)(tcellset45347* s, tcell45335* cell);
static N_INLINE(tcell45335*, usrtocell_49046)(void* usr);
static N_INLINE(void, decref_51004)(tcell45335* c);
static N_INLINE(void, rtladdzct_50604)(tcell45335* c);
N_NOINLINE(void, addzct_49017)(tcellseq45351* s, tcell45335* c);
N_NIMCALL(NimStringDesc*, copyStringRC1)(NimStringDesc* src);
static N_INLINE(void, nimGCunrefNoCycle)(void* p);
N_NIMCALL(void, genericAssign)(void* dest, void* src, TNimType* mt);
N_NIMCALL(futureHEX3Aobjecttype160094*, newfuture_165426)(NimStringDesc* fromproc_165430);
N_CLOSURE(futurebaseHEX3Aobjecttype160014*, responditer_185166)(void* ClEnv);
N_NIMCALL(void, nstPut)(stringtableobj173012* t, NimStringDesc* key, NimStringDesc* val);
N_NIMCALL(NimStringDesc*, nimIntToStr)(NI x);
N_NIMCALL(NimStringDesc*, reprEnum)(NI e_81307, TNimType* typ);
static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src);
N_NIMCALL(void, read_175625)(futureHEX3Aobjecttype160094* future_175631);
N_NIMCALL(void, complete_160087)(futureHEX3Aobjecttype160094* future);
N_CLOSURE(void, cb_185223)(void* ClEnv);
static N_INLINE(void, pushSafePoint)(TSafePoint* s);
static N_INLINE(NIM_BOOL, finished_171246)(TY170666 x_171250);
N_NIMCALL(void, failedassertimpl_85425)(NimStringDesc* msg);
N_NIMCALL(void, callbackHEX3D_160849)(futurebaseHEX3Aobjecttype160014* future, TY160015 cb);
static N_INLINE(void, popSafePoint)(void);
static N_INLINE(void, setFrame)(TFrame* s);
N_NIMCALL(void, reraiseException)(void);
N_NIMCALL(void, fail_165669)(futureHEX3Aobjecttype160094* future_165675, Exception* error_165678);
static N_INLINE(Exception*, getCurrentException)(void);
static N_INLINE(void, popCurrentException)(void);
N_NIMCALL(void, newrequest_185441)(request185005* Result);
N_NIMCALL(stringtableobj173012*, nstnewStringTable)(NU8 mode);
N_NIMCALL(void, unsureAsgnRef)(void** dest, void* src);
N_NIMCALL(void, parseheader_185450)(NimStringDesc* line, TY109352* Result);
static N_INLINE(NI, parseuntil_93107)(NimStringDesc* s, NimStringDesc** token, NIM_CHAR until, NI start);
static N_INLINE(NI, subInt)(NI a, NI b);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* s, NI start_75228, NI last);
N_NIMCALL(NimStringDesc*, copyStrLast)(NimStringDesc* s, NI first, NI last);
static N_INLINE(NI, skipwhitespace_92830)(NimStringDesc* s, NI start);
static N_INLINE(NI, parseuntil_93058)(NimStringDesc* s, NimStringDesc** token, TY76268 until, NI start);
N_NIMCALL(void, parseprotocol_185503)(NimStringDesc* protocol, TY185074* Result);
N_NIMCALL(NI, skipignorecase_92905)(NimStringDesc* s, NimStringDesc* token, NI start);
N_NIMCALL(void, raiseException)(Exception* e, NCSTRING ename);
N_NIMCALL(NI, npuParseInt)(NimStringDesc* s, NI* number, NI start);
N_NIMCALL(futureHEX3Aobjecttype160094*, sendstatus_185577)(asyncsocketdesc175202* client, NimStringDesc* status);
N_NIMCALL(void, asynccheck_185875)(futureHEX3Aobjecttype160094* future_185881);
N_NIMCALL(futureHEX3Aobjecttype160094*, processclient_185603)(asyncsocketdesc175202* client, NimStringDesc* address, TY185607 callback);
N_NIMCALL(void, TMP641)(void* p, NI op);
N_CLOSURE(futurebaseHEX3Aobjecttype160014*, processclientiter_185592)(void* ClEnv);
N_NIMCALL(NIM_BOOL, isclosed_183649)(asyncsocketdesc175202* socket);
N_NIMCALL(futureHEX3Aobjecttype165748*, recvline_182302)(asyncsocketdesc175202* socket, NU8 flags);
N_NIMCALL(NimStringDesc*, read_170677)(futureHEX3Aobjecttype165748* future_170683);
N_NIMCALL(void, close_183215)(asyncsocketdesc175202* socket);
N_NIMCALL(TY13406*, nsuSplitChar)(NimStringDesc* s, NIM_CHAR sep);
N_NIMCALL(stringtableobj173012*, nstnewStringTableWithTableConstr)(TY109352* keyvaluepairs, NI keyvaluepairsLen0, NU8 mode);
static N_INLINE(NIM_BOOL, eqStrings)(NimStringDesc* a, NimStringDesc* b);
N_NIMCALL(void, parseuri_184187)(NimStringDesc* uri, uri184012* Result);
N_NIMCALL(NIM_BOOL, isObj)(TNimType* obj, TNimType* subclass);
N_NIMCALL(NimStringDesc*, nsuNormalize)(NimStringDesc* s);
N_NIMCALL(NIM_BOOL, nsthasKey)(stringtableobj173012* t, NimStringDesc* key);
N_NIMCALL(NimStringDesc*, nsuToLowerStr)(NimStringDesc* s);
N_NIMCALL(NimStringDesc*, nstGet)(stringtableobj173012* t, NimStringDesc* key);
N_NIMCALL(futureHEX3Aobjecttype165748*, recv_178443)(asyncsocketdesc175202* socket, NI size, NU8 flags);
N_NIMCALL(NI, hashString)(NimStringDesc* s);
N_CLOSURE(void, cb_186040)(void* ClEnv);
N_NIMCALL(futureHEX3Aobjecttype160094*, serve_186264)(asynchttpserverHEX3Aobjecttype185023* server, NU16 port, TY185607 callback, NimStringDesc* address);
N_NIMCALL(void, TMP676)(void* p, NI op);
N_CLOSURE(futurebaseHEX3Aobjecttype160014*, serveiter_186262)(void* ClEnv);
N_NIMCALL(asyncsocketdesc175202*, newasyncsocket_175439)(NU8 domain, NU8 typ, NU8 protocol, NIM_BOOL buffered);
N_NIMCALL(void, setsockopt_183615)(asyncsocketdesc175202* socket, NU8 opt, NIM_BOOL value, int level);
N_NIMCALL(void, bindaddr_183056)(asyncsocketdesc175202* socket, NU16 port, NimStringDesc* address);
N_NIMCALL(void, listen_183045)(asyncsocketdesc175202* socket, int backlog);
N_NIMCALL(futureHEX3Aobjecttype179452*, acceptaddr_179438)(asyncsocketdesc175202* socket, NU8 flags);
N_NIMCALL(void, read_181619)(futureHEX3Aobjecttype179452* future_181625, TY179445* Result);
N_CLOSURE(void, cb_186317)(void* ClEnv);
N_NIMCALL(void, close_186440)(asynchttpserverHEX3Aobjecttype185023* server);
STRING_LITERAL(TMP603, ": ", 2);
STRING_LITERAL(TMP604, "\015\012", 2);
STRING_LITERAL(TMP605, "", 0);
STRING_LITERAL(TMP613, "respond", 7);
STRING_LITERAL(TMP614, "Content-Length", 14);
STRING_LITERAL(TMP615, "HTTP/1.1 ", 9);
STRING_LITERAL(TMP618, "retFuture.(asyncdispatch.finished|system.finished|...) Async pr"
"ocedure\'s (respond) return Future was not finished.", 114);
static NIM_CONST TY76268 TMP625 = {
0x00, 0x24, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP629, "HTTP/", 5);
STRING_LITERAL(TMP630, "Invalid request protocol. Got: ", 31);
STRING_LITERAL(TMP642, "processClient", 13);
STRING_LITERAL(TMP643, "client != nil ", 14);
STRING_LITERAL(TMP646, "Invalid request. Got: ", 22);
STRING_LITERAL(TMP650, "post", 4);
STRING_LITERAL(TMP651, "Expect", 6);
STRING_LITERAL(TMP652, "100-continue", 12);
STRING_LITERAL(TMP653, "100 Continue", 12);
STRING_LITERAL(TMP654, "417 Expectation Failed", 22);
STRING_LITERAL(TMP655, "Bad Request. Invalid Content-Length.", 36);
STRING_LITERAL(TMP656, "request.body.len == contentLength ", 34);
STRING_LITERAL(TMP657, "Bad Request. No Content-Length.", 31);
STRING_LITERAL(TMP658, "get", 3);
STRING_LITERAL(TMP659, "head", 4);
STRING_LITERAL(TMP660, "put", 3);
STRING_LITERAL(TMP661, "delete", 6);
STRING_LITERAL(TMP662, "trace", 5);
STRING_LITERAL(TMP663, "options", 7);
STRING_LITERAL(TMP664, "connect", 7);
STRING_LITERAL(TMP665, "patch", 5);
STRING_LITERAL(TMP667, "Invalid request method. Got: ", 29);
STRING_LITERAL(TMP668, "connection", 10);
STRING_LITERAL(TMP669, "close", 5);
STRING_LITERAL(TMP670, "keep-alive", 10);
STRING_LITERAL(TMP673, "retFuture.(asyncdispatch.finished|system.finished|...) Async pr"
"ocedure\'s (processClient) return Future was not finished.", 120);
STRING_LITERAL(TMP677, "serve", 5);
STRING_LITERAL(TMP680, "retFuture.(asyncdispatch.finished|system.finished|...) Async pr"
"ocedure\'s (serve) return Future was not finished.", 112);
extern TFrame* frameptr_16442;
TNimType NTI185023; /* AsyncHttpServer:ObjectType */
extern TNimType NTI175204; /* AsyncSocket */
extern TNimType NTI138; /* bool */
TNimType NTI185007; /* AsyncHttpServer */
TNimType NTI185414; /* object */
extern TNimType NTI176416; /* range -1..1(int) */
extern TNimType NTI173014; /* StringTableRef */
extern TNimType NTI149; /* string */
TNimType NTI185009; /* HttpCode */
TNimType NTI185005; /* Request */
TNimType NTI185074; /* tuple[orig: string, major: int, minor: int] */
extern TNimType NTI108; /* int */
extern TNimType NTI184012; /* Uri */
extern TNimType NTI160093; /* Future */
extern TNimType NTI170666; /* iterator (): FutureBase{.closure, gcsafe, locks: <unknown>.} */
TNimType NTI185434; /* ref object */
extern tgcheap47416 gch_47444;
extern TSafePoint* exchandler_16443;
extern Exception* currexception_16445;
extern TNimType NTI21801; /* ref ValueError */
extern TNimType NTI3249; /* ValueError */
TNimType NTI186214; /* object */
TNimType NTI186216; /* range -1..10(int) */
TNimType NTI185607; /* tuple[pointer, ref tuple[]] */
extern TNimType NTI153; /* pointer */
extern TNimType NTI161266; /* ref tuple[] */
extern TNimType NTI165747; /* Future */
extern TNimType NTI13406; /* seq[string] */
extern TNimType NTI109352; /* tuple[nonDST: string, DST: string] */
TNimType NTI186233; /* ref object */
TNimType NTI186414; /* object */
extern TNimType NTI122; /* uint16 */
extern TNimType NTI179451; /* Future */
extern TNimType NTI179445; /* tuple[address: string, client: AsyncSocket] */
TNimType NTI186434; /* ref object */

static N_INLINE(void, nimFrame)(TFrame* s) {
	NI LOC1;
	LOC1 = 0;
	{
		if (!(frameptr_16442 == NIM_NIL)) goto LA4;
		LOC1 = 0;
	}
	goto LA2;
	LA4: ;
	{
		LOC1 = ((NI) ((NI16)((*frameptr_16442).calldepth + ((NI16) 1))));
	}
	LA2: ;
	(*s).calldepth = ((NI16) (LOC1));
	(*s).prev = frameptr_16442;
	frameptr_16442 = s;
	{
		if (!((*s).calldepth == ((NI16) 2000))) goto LA9;
		stackoverflow_19001();
	}
	LA9: ;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_16442 = (*frameptr_16442).prev;
}

N_NIMCALL(NIM_BOOL, HEX3DHEX3D_185072)(TY185074* protocol, NU8 ver) {
	NIM_BOOL result;
	NI major;
	NI minor;
	NIM_BOOL LOC4;
	nimfr("==", "asynchttpserver.nim")
	result = 0;
	nimln(86, "asynchttpserver.nim");
	nimln(87, "asynchttpserver.nim");
	switch (ver) {
	case ((NU8) 0):
	case ((NU8) 1):
	{
		major = 1;
	}
	break;
	}
	nimln(89, "asynchttpserver.nim");
	nimln(90, "asynchttpserver.nim");
	switch (ver) {
	case ((NU8) 0):
	{
		minor = 1;
	}
	break;
	case ((NU8) 1):
	{
		minor = 0;
	}
	break;
	}
	nimln(93, "asynchttpserver.nim");
	nimln(93, "asynchttpserver.nim");
	LOC4 = 0;
	nimln(93, "asynchttpserver.nim");
	LOC4 = ((*protocol).Field1 == major);
	if (!(LOC4)) goto LA5;
	nimln(93, "asynchttpserver.nim");
	LOC4 = ((*protocol).Field2 == minor);
	LA5: ;
	result = LOC4;
	popFrame();
	return result;
}
N_NIMCALL(void, TMP602)(void* p, NI op) {
	asynchttpserverHEX3Aobjecttype185023* a;
	a = (asynchttpserverHEX3Aobjecttype185023*)p;
	nimGCvisit((void*)(*a).Socket, op);
}

N_NIMCALL(asynchttpserverHEX3Aobjecttype185023*, newasynchttpserver_185089)(NIM_BOOL reuseaddr) {
	asynchttpserverHEX3Aobjecttype185023* result;
	nimfr("newAsyncHttpServer", "asynchttpserver.nim")
	result = 0;
	nimln(97, "asynchttpserver.nim");
	result = (asynchttpserverHEX3Aobjecttype185023*) newObj((&NTI185007), sizeof(asynchttpserverHEX3Aobjecttype185023));
	nimln(98, "asynchttpserver.nim");
	(*result).Reuseaddr = reuseaddr;
	popFrame();
	return result;
}

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	memcpy(((NCSTRING) ((&(*dest).data[((*dest).Sup.len)- 0]))), ((NCSTRING) ((*src).data)), (NI64)((*src).Sup.len + 1));
	(*dest).Sup.len += (*src).Sup.len;
}

static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU64)(a) + (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

N_NIMCALL(void, addheaders_185115)(NimStringDesc** msg, stringtableobj173012* headers) {
	nimfr("addHeaders", "asynchttpserver.nim")
	{
		NimStringDesc* k_185120;
		NimStringDesc* v_185121;
		k_185120 = 0;
		v_185121 = 0;
		{
			NI h_185126;
			NI HEX3Atmp_185128;
			NI res_185130;
			h_185126 = 0;
			HEX3Atmp_185128 = 0;
			nimln(43, "strtabs.nim");
			nimln(43, "strtabs.nim");
			HEX3Atmp_185128 = ((*headers).Data->Sup.len-1);
			nimln(1576, "system.nim");
			res_185130 = 0;
			{
				nimln(1577, "system.nim");
				while (1) {
					nimln(1577, "system.nim");
					if (!(res_185130 <= HEX3Atmp_185128)) goto LA4;
					nimln(1576, "system.nim");
					h_185126 = res_185130;
					nimln(44, "strtabs.nim");
					{
						NimStringDesc* LOC9;
						nimln(44, "strtabs.nim");
						nimln(44, "strtabs.nim");
						if ((NU)(h_185126) >= (NU)((*headers).Data->Sup.len)) raiseIndexError();
						if (!!((*headers).Data->data[h_185126].Field0 == 0)) goto LA7;
						nimln(45, "strtabs.nim");
						if ((NU)(h_185126) >= (NU)((*headers).Data->Sup.len)) raiseIndexError();
						k_185120 = (*headers).Data->data[h_185126].Field0;
						nimln(45, "strtabs.nim");
						if ((NU)(h_185126) >= (NU)((*headers).Data->Sup.len)) raiseIndexError();
						v_185121 = (*headers).Data->data[h_185126].Field1;
						nimln(102, "asynchttpserver.nim");
						nimln(102, "asynchttpserver.nim");
						LOC9 = 0;
						LOC9 = rawNewString(k_185120->Sup.len + v_185121->Sup.len + 4);
appendString(LOC9, k_185120);
appendString(LOC9, ((NimStringDesc*) &TMP603));
appendString(LOC9, v_185121);
appendString(LOC9, ((NimStringDesc*) &TMP604));
						(*msg) = resizeString((*msg), LOC9->Sup.len + 0);
appendString((*msg), LOC9);
					}
					LA7: ;
					nimln(1579, "system.nim");
					res_185130 = addInt(res_185130, 1);
				} LA4: ;
			}
		}
	}
	popFrame();
}

N_NIMCALL(futureHEX3Aobjecttype160094*, sendheaders_185149)(request185005* req, stringtableobj173012* headers) {
	futureHEX3Aobjecttype160094* result;
	NimStringDesc* msg;
	nimfr("sendHeaders", "asynchttpserver.nim")
	result = 0;
	nimln(106, "asynchttpserver.nim");
	msg = copyString(((NimStringDesc*) &TMP605));
	nimln(107, "asynchttpserver.nim");
	addheaders_185115((&msg), headers);
	nimln(108, "asynchttpserver.nim");
	nimln(108, "asynchttpserver.nim");
	result = send_178851((*req).Client, msg, 2);
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}
N_NIMCALL(void, TMP612)(void* p, NI op) {
	TY185414* a;
	a = (TY185414*)p;
	nimGCvisit((void*)(*a).Headers185183, op);
	nimGCvisit((void*)(*a).Content185172, op);
	nimGCvisit((void*)(*a).Req185170.Client, op);
	nimGCvisit((void*)(*a).Req185170.Reqmethod, op);
	nimGCvisit((void*)(*a).Req185170.Headers, op);
	nimGCvisit((void*)(*a).Req185170.Protocol.Field0, op);
	nimGCvisit((void*)(*a).Req185170.Url.Scheme, op);
	nimGCvisit((void*)(*a).Req185170.Url.Username, op);
	nimGCvisit((void*)(*a).Req185170.Url.Password, op);
	nimGCvisit((void*)(*a).Req185170.Url.Hostname, op);
	nimGCvisit((void*)(*a).Req185170.Url.Port, op);
	nimGCvisit((void*)(*a).Req185170.Url.Path, op);
	nimGCvisit((void*)(*a).Req185170.Url.Query, op);
	nimGCvisit((void*)(*a).Req185170.Url.Anchor, op);
	nimGCvisit((void*)(*a).Req185170.Hostname, op);
	nimGCvisit((void*)(*a).Req185170.Body, op);
	nimGCvisit((void*)(*a).Retfuture185165, op);
	nimGCvisit((void*)(*a).Nameitervar185220.ClEnv, op);
	nimGCvisit((void*)(*a).Customheaders185197, op);
	nimGCvisit((void*)(*a).Msg185205, op);
	nimGCvisit((void*)(*a).Future185167, op);
}

static N_INLINE(NIM_BOOL, canbecycleroot_49067)(tcell45335* c) {
	NIM_BOOL result;
	nimfr("canbeCycleRoot", "gc.nim")
	result = 0;
	nimln(121, "gc.nim");
	nimln(121, "gc.nim");
	nimln(121, "gc.nim");
	result = !((((*(*c).Typ).flags &(1<<((((NU8) 1))&7)))!=0));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdcycleroot_49829)(tcell45335* c) {
	nimfr("rtlAddCycleRoot", "gc.nim")
	nimln(189, "gc.nim");
	{
		nimln(189, "gc.nim");
		nimln(189, "gc.nim");
		nimln(189, "gc.nim");
		if (!!((((NI) ((NI)((*c).Refcount & 3))) == 3))) goto LA3;
		nimln(139, "gc.nim");
		nimln(139, "gc.nim");
		nimln(139, "gc.nim");
		(*c).Refcount = (NI)((NI)((*c).Refcount & -4) | 3);
		nimln(191, "gc.nim");
		incl_46071((&gch_47444.Cycleroots), c);
	}
	LA3: ;
	popFrame();
}

static N_INLINE(void, incref_51425)(tcell45335* c) {
	nimfr("incRef", "gc.nim")
	nimln(216, "gc.nim");
	nimln(216, "gc.nim");
	(*c).Refcount = (NI)((NU64)((*c).Refcount) + (NU64)(8));
	nimln(219, "gc.nim");
	{
		NIM_BOOL LOC3;
		nimln(219, "gc.nim");
		LOC3 = 0;
		LOC3 = canbecycleroot_49067(c);
		if (!LOC3) goto LA4;
		nimln(220, "gc.nim");
		rtladdcycleroot_49829(c);
	}
	LA4: ;
	popFrame();
}

static N_INLINE(tcell45335*, usrtocell_49046)(void* usr) {
	tcell45335* result;
	nimfr("usrToCell", "gc.nim")
	result = 0;
	nimln(118, "gc.nim");
	nimln(118, "gc.nim");
	nimln(118, "gc.nim");
	result = ((tcell45335*) ((NI)((NU64)(((NI) (usr))) - (NU64)(((NI)sizeof(tcell45335))))));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdzct_50604)(tcell45335* c) {
	nimfr("rtlAddZCT", "gc.nim")
	nimln(199, "gc.nim");
	addzct_49017((&gch_47444.Zct), c);
	popFrame();
}

static N_INLINE(void, decref_51004)(tcell45335* c) {
	nimfr("decRef", "gc.nim")
	nimln(206, "gc.nim");
	{
		nimln(167, "gc.nim");
		(*c).Refcount -= 8;
		nimln(168, "gc.nim");
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		nimln(207, "gc.nim");
		rtladdzct_50604(c);
	}
	goto LA1;
	LA3: ;
	{
		NIM_BOOL LOC6;
		nimln(208, "gc.nim");
		LOC6 = 0;
		LOC6 = canbecycleroot_49067(c);
		if (!LOC6) goto LA7;
		nimln(211, "gc.nim");
		rtladdcycleroot_49829(c);
	}
	goto LA1;
	LA7: ;
	LA1: ;
	popFrame();
}

static N_INLINE(void, asgnRef)(void** dest, void* src) {
	nimfr("asgnRef", "gc.nim")
	nimln(244, "gc.nim");
	{
		tcell45335* LOC5;
		nimln(244, "gc.nim");
		nimln(244, "gc.nim");
		if (!!((src == NIM_NIL))) goto LA3;
		nimln(244, "gc.nim");
		nimln(244, "gc.nim");
		LOC5 = 0;
		LOC5 = usrtocell_49046(src);
		incref_51425(LOC5);
	}
	LA3: ;
	nimln(245, "gc.nim");
	{
		tcell45335* LOC10;
		nimln(245, "gc.nim");
		nimln(245, "gc.nim");
		if (!!(((*dest) == NIM_NIL))) goto LA8;
		nimln(245, "gc.nim");
		nimln(245, "gc.nim");
		LOC10 = 0;
		LOC10 = usrtocell_49046((*dest));
		decref_51004(LOC10);
	}
	LA8: ;
	nimln(246, "gc.nim");
	(*dest) = src;
	popFrame();
}

static N_INLINE(void, nimGCunrefNoCycle)(void* p) {
	tcell45335* c;
	nimfr("nimGCunrefNoCycle", "gc.nim")
	nimln(233, "gc.nim");
	c = usrtocell_49046(p);
	nimln(235, "gc.nim");
	{
		nimln(167, "gc.nim");
		(*c).Refcount -= 8;
		nimln(168, "gc.nim");
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		nimln(236, "gc.nim");
		rtladdzct_50604(c);
	}
	LA3: ;
	popFrame();
}

static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src) {
	nimfr("asgnRefNoCycle", "gc.nim")
	nimln(251, "gc.nim");
	{
		tcell45335* c;
		nimln(251, "gc.nim");
		nimln(251, "gc.nim");
		if (!!((src == NIM_NIL))) goto LA3;
		nimln(252, "gc.nim");
		c = usrtocell_49046(src);
		nimln(169, "gc.nim");
		(*c).Refcount += 8;
	}
	LA3: ;
	nimln(254, "gc.nim");
	{
		tcell45335* c;
		nimln(254, "gc.nim");
		nimln(254, "gc.nim");
		if (!!(((*dest) == NIM_NIL))) goto LA7;
		nimln(255, "gc.nim");
		c = usrtocell_49046((*dest));
		nimln(256, "gc.nim");
		{
			nimln(167, "gc.nim");
			(*c).Refcount -= 8;
			nimln(168, "gc.nim");
			if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA11;
			nimln(257, "gc.nim");
			rtladdzct_50604(c);
		}
		LA11: ;
	}
	LA7: ;
	nimln(258, "gc.nim");
	(*dest) = src;
	popFrame();
}

N_CLOSURE(futurebaseHEX3Aobjecttype160014*, responditer_185166)(void* ClEnv) {
	futurebaseHEX3Aobjecttype160014* result;
	TY185414* HEX3Aenvp_185420;
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	NimStringDesc* LOC3;
	nimfr("respondIter", "asyncdispatch.nim")
	result = 0;
	HEX3Aenvp_185420 = (TY185414*) ClEnv;
	switch ((*HEX3Aenvp_185420).HEX3Astate) {
	case -1: goto BeforeRet;
	case 0: goto STATE0;
	case 1: goto STATE1;
	}
	STATE0: ;
	nimln(116, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenvp_185420).Customheaders185197), (*HEX3Aenvp_185420).Headers185183);
	nimln(117, "asynchttpserver.nim");
	nimln(117, "asynchttpserver.nim");
	nimln(117, "asynchttpserver.nim");
	LOC1 = 0;
	LOC1 = nimIntToStr((*HEX3Aenvp_185420).Content185172->Sup.len);
	nstPut((*HEX3Aenvp_185420).Customheaders185197, ((NimStringDesc*) &TMP614), LOC1);
	nimln(118, "asynchttpserver.nim");
	nimln(118, "asynchttpserver.nim");
	LOC2 = 0;
	nimln(118, "asynchttpserver.nim");
	LOC2 = rawNewString(reprEnum((*HEX3Aenvp_185420).Code185171, (&NTI185009))->Sup.len + 11);
appendString(LOC2, ((NimStringDesc*) &TMP615));
appendString(LOC2, reprEnum((*HEX3Aenvp_185420).Code185171, (&NTI185009)));
appendString(LOC2, ((NimStringDesc*) &TMP604));
	asgnRefNoCycle((void**) (&(*HEX3Aenvp_185420).Msg185205), LOC2);
	nimln(119, "asynchttpserver.nim");
	addheaders_185115((&(*HEX3Aenvp_185420).Msg185205), (*HEX3Aenvp_185420).Customheaders185197);
	nimln(120, "asynchttpserver.nim");
	nimln(120, "asynchttpserver.nim");
	LOC3 = 0;
	LOC3 = rawNewString((*HEX3Aenvp_185420).Msg185205->Sup.len + (*HEX3Aenvp_185420).Content185172->Sup.len + 2);
appendString(LOC3, (*HEX3Aenvp_185420).Msg185205);
appendString(LOC3, ((NimStringDesc*) &TMP604));
appendString(LOC3, (*HEX3Aenvp_185420).Content185172);
	asgnRef((void**) (&(*HEX3Aenvp_185420).Future185167), send_178851((*HEX3Aenvp_185420).Req185170.Client, LOC3, 2));
	nimln(120, "asynchttpserver.nim");
	(*HEX3Aenvp_185420).HEX3Astate = 1;
	nimln(120, "asynchttpserver.nim");
	nimln(1137, "asyncdispatch.nim");
	result = &(*HEX3Aenvp_185420).Future185167->Sup;
	goto BeforeRet;
	STATE1: ;
	nimln(120, "asynchttpserver.nim");
	read_175625((*HEX3Aenvp_185420).Future185167);
	nimln(120, "asynchttpserver.nim");
	complete_160087((*HEX3Aenvp_185420).Retfuture185165);
	nimln(1287, "asyncdispatch.nim");
	(*HEX3Aenvp_185420).HEX3Astate = -1;
	BeforeRet: ;
	popFrame();
	return result;
}

static N_INLINE(void, pushSafePoint)(TSafePoint* s) {
	(*s).hasRaiseAction = NIM_FALSE;
	(*s).prev = exchandler_16443;
	exchandler_16443 = s;
}

static N_INLINE(NIM_BOOL, finished_171246)(TY170666 x_171250) {
	NIM_BOOL result;
	nimfr("finished", "system.nim")
	result = 0;
	nimln(2696, "system.nim");
	      result = *((NI*) x_171250.ClEnv) < 0;
      
	popFrame();
	return result;
}

static N_INLINE(void, popSafePoint)(void) {
	exchandler_16443 = (*exchandler_16443).prev;
}

static N_INLINE(void, setFrame)(TFrame* s) {
	frameptr_16442 = s;
}

static N_INLINE(Exception*, getCurrentException)(void) {
	Exception* result;
	nimfr("getCurrentException", "system.nim")
	result = 0;
	nimln(2619, "system.nim");
	result = currexception_16445;
	popFrame();
	return result;
}

static N_INLINE(void, popCurrentException)(void) {
	asgnRef((void**) (&currexception_16445), (*currexception_16445).parent);
}

N_CLOSURE(void, cb_185223)(void* ClEnv) {
	TY185414* HEX3Aenvp_185430;
	TSafePoint TMP616;
	nimfr("cb", "asyncdispatch.nim")
	HEX3Aenvp_185430 = (TY185414*) ClEnv;
	nimln(1068, "asyncdispatch.nim");
	pushSafePoint(&TMP616);
	TMP616.status = _setjmp(TMP616.context);
	if (TMP616.status == 0) {
		nimln(1069, "asyncdispatch.nim");
		{
			NIM_BOOL LOC4;
			futurebaseHEX3Aobjecttype160014* next_185222;
			nimln(1069, "asyncdispatch.nim");
			nimln(1069, "asyncdispatch.nim");
			LOC4 = 0;
			LOC4 = finished_171246((*HEX3Aenvp_185430).Nameitervar185220);
			if (!!(LOC4)) goto LA5;
			nimln(1070, "asyncdispatch.nim");
			next_185222 = (*HEX3Aenvp_185430).Nameitervar185220.ClPrc((*HEX3Aenvp_185430).Nameitervar185220.ClEnv);
			nimln(1071, "asyncdispatch.nim");
			{
				nimln(1071, "asyncdispatch.nim");
				if (!(next_185222 == NIM_NIL)) goto LA9;
				nimln(1072, "asyncdispatch.nim");
				{
					nimln(1072, "asyncdispatch.nim");
					if (!!((*(*HEX3Aenvp_185430).Retfuture185165).Sup.Finished)) goto LA13;
					nimln(1072, "asyncdispatch.nim");
					failedassertimpl_85425(((NimStringDesc*) &TMP618));
				}
				LA13: ;
			}
			goto LA7;
			LA9: ;
			{
				TY160015 LOC16;
				nimln(1075, "asyncdispatch.nim");
				memset((void*)(&LOC16), 0, sizeof(LOC16));
				LOC16.ClPrc = cb_185223; LOC16.ClEnv = HEX3Aenvp_185430;
				callbackHEX3D_160849(next_185222, LOC16);
			}
			LA7: ;
		}
		LA5: ;
		popSafePoint();
	}
	else {
		popSafePoint();
		setFrame((TFrame*)&F);
		{
			TMP616.status = 0;
			nimln(1077, "asyncdispatch.nim");
			{
				if (!(*(*HEX3Aenvp_185430).Retfuture185165).Sup.Finished) goto LA21;
				nimln(1080, "asyncdispatch.nim");
				reraiseException();
			}
			goto LA19;
			LA21: ;
			{
				Exception* LOC24;
				nimln(1082, "asyncdispatch.nim");
				nimln(1082, "asyncdispatch.nim");
				LOC24 = 0;
				LOC24 = getCurrentException();
				fail_165669((*HEX3Aenvp_185430).Retfuture185165, LOC24);
			}
			LA19: ;
			popCurrentException();
		}
	}
	if (TMP616.status != 0) reraiseException();
	popFrame();
}

N_NIMCALL(futureHEX3Aobjecttype160094*, respond_185168)(request185005* req, NU8 code, NimStringDesc* content, stringtableobj173012* headers) {
	futureHEX3Aobjecttype160094* result;
	TY185414* HEX3Aenv_185433;
	NimStringDesc* LOC1;
	TY170666 LOC2;
	TY160015 LOC3;
	nimfr("respond", "asynchttpserver.nim")
	result = 0;
	HEX3Aenv_185433 = 0;
	nimln(172, "system.nim");
	HEX3Aenv_185433 = (TY185414*) newObj((&NTI185434), sizeof(TY185414));
	nimln(112, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenv_185433).Headers185183), headers);
	nimln(112, "asynchttpserver.nim");
	LOC1 = 0;
	LOC1 = (*HEX3Aenv_185433).Content185172; (*HEX3Aenv_185433).Content185172 = copyStringRC1(content);
	if (LOC1) nimGCunrefNoCycle(LOC1);
	nimln(112, "asynchttpserver.nim");
	(*HEX3Aenv_185433).Code185171 = code;
	nimln(112, "asynchttpserver.nim");
	genericAssign((void*)(&(*HEX3Aenv_185433).Req185170), (void*)req, (&NTI185005));
	nimln(110, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenv_185433).Retfuture185165), newfuture_165426(((NimStringDesc*) &TMP613)));
	nimln(1065, "asyncdispatch.nim");
	memset((void*)(&LOC2), 0, sizeof(LOC2));
	LOC2.ClPrc = responditer_185166; LOC2.ClEnv = HEX3Aenv_185433;
	asgnRef((void**) (&(*HEX3Aenv_185433).Nameitervar185220.ClEnv), LOC2.ClEnv);
	(*HEX3Aenv_185433).Nameitervar185220.ClPrc = LOC2.ClPrc;
	nimln(1083, "asyncdispatch.nim");
	memset((void*)(&LOC3), 0, sizeof(LOC3));
	LOC3.ClPrc = cb_185223; LOC3.ClEnv = HEX3Aenv_185433;
	LOC3.ClEnv? LOC3.ClPrc(LOC3.ClEnv):((TMP619)(LOC3.ClPrc))();
	nimln(120, "asynchttpserver.nim");
	nimln(1271, "asyncdispatch.nim");
	result = (*HEX3Aenv_185433).Retfuture185165;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, newrequest_185441)(request185005* Result) {
	nimfr("newRequest", "asynchttpserver.nim")
	nimln(123, "asynchttpserver.nim");
	unsureAsgnRef((void**) (&(*Result).Headers), nstnewStringTable(((NU8) 1)));
	nimln(124, "asynchttpserver.nim");
	unsureAsgnRef((void**) (&(*Result).Hostname), copyString(((NimStringDesc*) &TMP605)));
	nimln(125, "asynchttpserver.nim");
	unsureAsgnRef((void**) (&(*Result).Body), copyString(((NimStringDesc*) &TMP605)));
	popFrame();
}

static N_INLINE(NI, subInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU64)(a) - (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ (NI)((NU64) ~(b))));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

static N_INLINE(NI, parseuntil_93107)(NimStringDesc* s, NimStringDesc** token, NIM_CHAR until, NI start) {
	NI result;
	NI i;
	NI TMP620;
	NI TMP621;
	nimfr("parseUntil", "parseutils.nim")
	result = 0;
	nimln(168, "parseutils.nim");
	i = start;
	{
		nimln(169, "parseutils.nim");
		while (1) {
			NIM_BOOL LOC3;
			nimln(169, "parseutils.nim");
			LOC3 = 0;
			nimln(169, "parseutils.nim");
			nimln(169, "parseutils.nim");
			LOC3 = (i < s->Sup.len);
			if (!(LOC3)) goto LA4;
			nimln(169, "parseutils.nim");
			nimln(169, "parseutils.nim");
			if ((NU)(i) > (NU)(s->Sup.len)) raiseIndexError();
			LOC3 = !(((NU8)(s->data[i]) == (NU8)(until)));
			LA4: ;
			if (!LOC3) goto LA2;
			nimln(169, "parseutils.nim");
			i = addInt(i, 1);
		} LA2: ;
	}
	nimln(170, "parseutils.nim");
	nimln(170, "parseutils.nim");
	TMP620 = subInt(i, start);
	result = (NI64)(TMP620);
	nimln(171, "parseutils.nim");
	nimln(171, "parseutils.nim");
	nimln(171, "parseutils.nim");
	TMP621 = subInt(i, 1);
	unsureAsgnRef((void**) (&(*token)), copyStrLast(s, start, (NI64)(TMP621)));
	popFrame();
	return result;
}

static N_INLINE(NI, skipwhitespace_92830)(NimStringDesc* s, NI start) {
	NI result;
	nimfr("skipWhitespace", "parseutils.nim")
	result = 0;
	{
		nimln(122, "parseutils.nim");
		while (1) {
			NI TMP622;
			nimln(122, "parseutils.nim");
			nimln(122, "parseutils.nim");
			TMP622 = addInt(start, result);
			if ((NU)((NI64)(TMP622)) > (NU)(s->Sup.len)) raiseIndexError();
			if (!(((NU8)(s->data[(NI64)(TMP622)])) == ((NU8)(32)) || ((NU8)(s->data[(NI64)(TMP622)])) == ((NU8)(9)) || ((NU8)(s->data[(NI64)(TMP622)])) == ((NU8)(11)) || ((NU8)(s->data[(NI64)(TMP622)])) == ((NU8)(13)) || ((NU8)(s->data[(NI64)(TMP622)])) == ((NU8)(10)) || ((NU8)(s->data[(NI64)(TMP622)])) == ((NU8)(12)))) goto LA2;
			nimln(122, "parseutils.nim");
			result = addInt(result, 1);
		} LA2: ;
	}
	popFrame();
	return result;
}

static N_INLINE(NI, parseuntil_93058)(NimStringDesc* s, NimStringDesc** token, TY76268 until, NI start) {
	NI result;
	NI i;
	NI TMP623;
	NI TMP624;
	nimfr("parseUntil", "parseutils.nim")
	result = 0;
	nimln(158, "parseutils.nim");
	i = start;
	{
		nimln(159, "parseutils.nim");
		while (1) {
			NIM_BOOL LOC3;
			nimln(159, "parseutils.nim");
			LOC3 = 0;
			nimln(159, "parseutils.nim");
			nimln(159, "parseutils.nim");
			LOC3 = (i < s->Sup.len);
			if (!(LOC3)) goto LA4;
			nimln(159, "parseutils.nim");
			nimln(159, "parseutils.nim");
			if ((NU)(i) > (NU)(s->Sup.len)) raiseIndexError();
			LOC3 = !(((until[((NU8)(s->data[i]))/8] &(1<<(((NU8)(s->data[i]))%8)))!=0));
			LA4: ;
			if (!LOC3) goto LA2;
			nimln(159, "parseutils.nim");
			i = addInt(i, 1);
		} LA2: ;
	}
	nimln(160, "parseutils.nim");
	nimln(160, "parseutils.nim");
	TMP623 = subInt(i, start);
	result = (NI64)(TMP623);
	nimln(161, "parseutils.nim");
	nimln(161, "parseutils.nim");
	nimln(161, "parseutils.nim");
	TMP624 = subInt(i, 1);
	unsureAsgnRef((void**) (&(*token)), copyStrLast(s, start, (NI64)(TMP624)));
	popFrame();
	return result;
}

N_NIMCALL(void, parseheader_185450)(NimStringDesc* line, TY109352* Result) {
	NI i;
	NI LOC1;
	NI LOC2;
	nimfr("parseHeader", "asynchttpserver.nim")
	nimln(128, "asynchttpserver.nim");
	i = 0;
	nimln(129, "asynchttpserver.nim");
	i = parseuntil_93107(line, (&(*Result).Field0), 58, 0);
	nimln(130, "asynchttpserver.nim");
	i = addInt(i, 1);
	nimln(131, "asynchttpserver.nim");
	nimln(131, "asynchttpserver.nim");
	LOC1 = 0;
	LOC1 = skipwhitespace_92830(line, i);
	i = addInt(i, LOC1);
	nimln(132, "asynchttpserver.nim");
	nimln(132, "asynchttpserver.nim");
	LOC2 = 0;
	LOC2 = parseuntil_93058(line, (&(*Result).Field1), TMP625, i);
	i = addInt(i, LOC2);
	popFrame();
}

N_NIMCALL(void, parseprotocol_185503)(NimStringDesc* protocol, TY185074* Result) {
	NI i;
	NI LOC6;
	NI LOC7;
	nimfr("parseProtocol", "asynchttpserver.nim")
	nimln(135, "asynchttpserver.nim");
	i = skipignorecase_92905(protocol, ((NimStringDesc*) &TMP629), 0);
	nimln(136, "asynchttpserver.nim");
	{
		valueerror3249* e_185514;
		NimStringDesc* LOC5;
		nimln(136, "asynchttpserver.nim");
		nimln(136, "asynchttpserver.nim");
		if (!!((i == 5))) goto LA3;
		e_185514 = 0;
		nimln(2149, "system.nim");
		e_185514 = (valueerror3249*) newObj((&NTI21801), sizeof(valueerror3249));
		(*e_185514).Sup.Sup.m_type = (&NTI3249);
		nimln(2150, "system.nim");
		nimln(137, "asynchttpserver.nim");
		LOC5 = 0;
		LOC5 = rawNewString(protocol->Sup.len + 31);
appendString(LOC5, ((NimStringDesc*) &TMP630));
appendString(LOC5, protocol);
		asgnRefNoCycle((void**) (&(*e_185514).Sup.message), LOC5);
		nimln(137, "asynchttpserver.nim");
		raiseException((Exception*)e_185514, "ValueError");
	}
	LA3: ;
	nimln(139, "asynchttpserver.nim");
	unsureAsgnRef((void**) (&(*Result).Field0), copyString(protocol));
	nimln(140, "asynchttpserver.nim");
	nimln(140, "asynchttpserver.nim");
	LOC6 = 0;
	LOC6 = npuParseInt(protocol, (&(*Result).Field1), i);
	i = addInt(i, LOC6);
	nimln(141, "asynchttpserver.nim");
	i = addInt(i, 1);
	nimln(142, "asynchttpserver.nim");
	nimln(142, "asynchttpserver.nim");
	LOC7 = 0;
	LOC7 = npuParseInt(protocol, (&(*Result).Field2), i);
	i = addInt(i, LOC7);
	popFrame();
}

N_NIMCALL(futureHEX3Aobjecttype160094*, sendstatus_185577)(asyncsocketdesc175202* client, NimStringDesc* status) {
	futureHEX3Aobjecttype160094* result;
	NimStringDesc* LOC1;
	nimfr("sendStatus", "asynchttpserver.nim")
	result = 0;
	nimln(145, "asynchttpserver.nim");
	nimln(145, "asynchttpserver.nim");
	LOC1 = 0;
	LOC1 = rawNewString(status->Sup.len + 11);
appendString(LOC1, ((NimStringDesc*) &TMP615));
appendString(LOC1, status);
appendString(LOC1, ((NimStringDesc*) &TMP604));
	result = send_178851(client, LOC1, 2);
	popFrame();
	return result;
}
N_NIMCALL(void, TMP641)(void* p, NI op) {
	TY186214* a;
	a = (TY186214*)p;
	nimGCvisit((void*)(*a).Client185605, op);
	nimGCvisit((void*)(*a).Address185606, op);
	nimGCvisit((void*)(*a).Retfuture185591, op);
	nimGCvisit((void*)(*a).Callback185612.ClEnv, op);
	nimGCvisit((void*)(*a).Nameitervar186037.ClEnv, op);
	nimGCvisit((void*)(*a).Request185626.Client, op);
	nimGCvisit((void*)(*a).Request185626.Reqmethod, op);
	nimGCvisit((void*)(*a).Request185626.Headers, op);
	nimGCvisit((void*)(*a).Request185626.Protocol.Field0, op);
	nimGCvisit((void*)(*a).Request185626.Url.Scheme, op);
	nimGCvisit((void*)(*a).Request185626.Url.Username, op);
	nimGCvisit((void*)(*a).Request185626.Url.Password, op);
	nimGCvisit((void*)(*a).Request185626.Url.Hostname, op);
	nimGCvisit((void*)(*a).Request185626.Url.Port, op);
	nimGCvisit((void*)(*a).Request185626.Url.Path, op);
	nimGCvisit((void*)(*a).Request185626.Url.Query, op);
	nimGCvisit((void*)(*a).Request185626.Url.Anchor, op);
	nimGCvisit((void*)(*a).Request185626.Hostname, op);
	nimGCvisit((void*)(*a).Request185626.Body, op);
	nimGCvisit((void*)(*a).Future185593, op);
	nimGCvisit((void*)(*a).Line185829, op);
	nimGCvisit((void*)(*a).Lineparts185832, op);
	nimGCvisit((void*)(*a).Future185594, op);
	nimGCvisit((void*)(*a).Reqmethod185854, op);
	nimGCvisit((void*)(*a).Path185855, op);
	nimGCvisit((void*)(*a).Protocol185856, op);
	nimGCvisit((void*)(*a).Future185595, op);
	nimGCvisit((void*)(*a).Headerline185869, op);
	nimGCvisit((void*)(*a).Kv185872.Field0, op);
	nimGCvisit((void*)(*a).Kv185872.Field1, op);
	nimGCvisit((void*)(*a).Future185596, op);
	nimGCvisit((void*)(*a).Future185597, op);
	nimGCvisit((void*)(*a).Future185598, op);
	nimGCvisit((void*)(*a).Future185599, op);
	nimGCvisit((void*)(*a).Future185600, op);
	nimGCvisit((void*)(*a).Future185601, op);
	nimGCvisit((void*)(*a).Future185602, op);
}

static N_INLINE(NIM_BOOL, eqStrings)(NimStringDesc* a, NimStringDesc* b) {
	NIM_BOOL result;
	NIM_BOOL LOC11;
	int LOC13;
	result = 0;
	{
		if (!(a == b)) goto LA3;
		result = NIM_TRUE;
		goto BeforeRet;
	}
	LA3: ;
	{
		NIM_BOOL LOC7;
		LOC7 = 0;
		LOC7 = (a == NIM_NIL);
		if (LOC7) goto LA8;
		LOC7 = (b == NIM_NIL);
		LA8: ;
		if (!LOC7) goto LA9;
		result = NIM_FALSE;
		goto BeforeRet;
	}
	LA9: ;
	LOC11 = 0;
	LOC11 = ((*a).Sup.len == (*b).Sup.len);
	if (!(LOC11)) goto LA12;
	LOC13 = 0;
	LOC13 = memcmp(((NCSTRING) ((*a).data)), ((NCSTRING) ((*b).data)), (NI64)((*a).Sup.len * 1));
	LOC11 = (LOC13 == ((NI32) 0));
	LA12: ;
	result = LOC11;
	goto BeforeRet;
	BeforeRet: ;
	return result;
}

N_CLOSURE(futurebaseHEX3Aobjecttype160014*, processclientiter_185592)(void* ClEnv) {
	futurebaseHEX3Aobjecttype160014* result;
	TY186214* HEX3Aenvp_186220;
	nimfr("processClientIter", "asyncdispatch.nim")
	result = 0;
	HEX3Aenvp_186220 = (TY186214*) ClEnv;
	switch ((*HEX3Aenvp_186220).HEX3Astate) {
	case -1: goto BeforeRet;
	case 0: goto STATE0;
	case 1: goto STATE1;
	case 2: goto STATE2;
	case 3: goto STATE3;
	case 4: goto STATE4;
	case 5: goto STATE5;
	case 6: goto STATE6;
	case 7: goto STATE7;
	case 8: goto STATE8;
	case 9: goto STATE9;
	case 10: goto STATE10;
	}
	STATE0: ;
	{
		nimln(150, "asynchttpserver.nim");
		while (1) {
			NIM_BOOL LOC3;
			nimln(150, "asynchttpserver.nim");
			nimln(150, "asynchttpserver.nim");
			LOC3 = 0;
			LOC3 = isclosed_183649((*HEX3Aenvp_186220).Client185605);
			if (!!(LOC3)) goto LA2;
			{
				NimStringDesc* LOC5;
				NimStringDesc* LOC21;
				NimStringDesc* LOC22;
				NimStringDesc* LOC23;
				NimStringDesc* LOC34;
				TSafePoint TMP647;
				NimStringDesc* LOC80;
				nimln(154, "asynchttpserver.nim");
				newrequest_185441((&(*HEX3Aenvp_186220).Request185626));
				nimln(155, "asynchttpserver.nim");
				LOC5 = 0;
				LOC5 = (*HEX3Aenvp_186220).Request185626.Hostname; (*HEX3Aenvp_186220).Request185626.Hostname = copyStringRC1((*HEX3Aenvp_186220).Address185606);
				if (LOC5) nimGCunrefNoCycle(LOC5);
				nimln(156, "asynchttpserver.nim");
				{
					nimln(156, "asynchttpserver.nim");
					nimln(156, "asynchttpserver.nim");
					nimln(156, "asynchttpserver.nim");
					if (!!(!(((*HEX3Aenvp_186220).Client185605 == NIM_NIL)))) goto LA8;
					nimln(156, "asynchttpserver.nim");
					failedassertimpl_85425(((NimStringDesc*) &TMP643));
				}
				LA8: ;
				nimln(157, "asynchttpserver.nim");
				asgnRefNoCycle((void**) (&(*HEX3Aenvp_186220).Request185626.Client), (*HEX3Aenvp_186220).Client185605);
				nimln(160, "asynchttpserver.nim");
				asgnRef((void**) (&(*HEX3Aenvp_186220).Future185593), recvline_182302((*HEX3Aenvp_186220).Client185605, 2));
				nimln(160, "asynchttpserver.nim");
				(*HEX3Aenvp_186220).HEX3Astate = 1;
				nimln(160, "asynchttpserver.nim");
				nimln(1137, "asyncdispatch.nim");
				result = &(*HEX3Aenvp_186220).Future185593->Sup;
				goto BeforeRet;
				STATE1: ;
				nimln(160, "asynchttpserver.nim");
				asgnRefNoCycle((void**) (&(*HEX3Aenvp_186220).Line185829), read_170677((*HEX3Aenvp_186220).Future185593));
				nimln(161, "asynchttpserver.nim");
				{
					nimln(161, "asynchttpserver.nim");
					if (!(((*HEX3Aenvp_186220).Line185829) && ((*HEX3Aenvp_186220).Line185829)->Sup.len == 0)) goto LA12;
					nimln(162, "asynchttpserver.nim");
					close_183215((*HEX3Aenvp_186220).Client185605);
					nimln(1576, "os.nim");
					complete_160087((*HEX3Aenvp_186220).Retfuture185591);
					nimln(163, "asynchttpserver.nim");
					(*HEX3Aenvp_186220).HEX3Astate = -1;
					nimln(163, "asynchttpserver.nim");
					nimln(1576, "os.nim");
					result = NIM_NIL;
					goto BeforeRet;
				}
				LA12: ;
				nimln(164, "asynchttpserver.nim");
				asgnRefNoCycle((void**) (&(*HEX3Aenvp_186220).Lineparts185832), nsuSplitChar((*HEX3Aenvp_186220).Line185829, 32));
				nimln(165, "asynchttpserver.nim");
				{
					NimStringDesc* LOC18;
					TY185182 LOC19;
					stringtableobj173012* LOC20;
					nimln(165, "asynchttpserver.nim");
					nimln(165, "asynchttpserver.nim");
					nimln(165, "asynchttpserver.nim");
					if (!!(((*HEX3Aenvp_186220).Lineparts185832->Sup.len == 3))) goto LA16;
					nimln(166, "asynchttpserver.nim");
					nimln(166, "asynchttpserver.nim");
					LOC18 = 0;
					LOC18 = rawNewString((*HEX3Aenvp_186220).Line185829->Sup.len + 22);
appendString(LOC18, ((NimStringDesc*) &TMP646));
appendString(LOC18, (*HEX3Aenvp_186220).Line185829);
					nimln(111, "asynchttpserver.nim");
					memset((void*)LOC19, 0, sizeof(LOC19));
					LOC20 = 0;
					LOC20 = nstnewStringTableWithTableConstr(LOC19, 0, ((NU8) 0));
					asgnRef((void**) (&(*HEX3Aenvp_186220).Future185594), respond_185168((&(*HEX3Aenvp_186220).Request185626), ((NU8) 15), LOC18, LOC20));
					nimln(166, "asynchttpserver.nim");
					(*HEX3Aenvp_186220).HEX3Astate = 2;
					nimln(166, "asynchttpserver.nim");
					nimln(1137, "asyncdispatch.nim");
					result = &(*HEX3Aenvp_186220).Future185594->Sup;
					goto BeforeRet;
					STATE2: ;
					nimln(166, "asynchttpserver.nim");
					read_175625((*HEX3Aenvp_186220).Future185594);
					nimln(167, "asynchttpserver.nim");
					goto LA4;
				}
				LA16: ;
				nimln(169, "asynchttpserver.nim");
				if ((NU)(0) >= (NU)((*HEX3Aenvp_186220).Lineparts185832->Sup.len)) raiseIndexError();
				LOC21 = 0;
				LOC21 = (*HEX3Aenvp_186220).Reqmethod185854; (*HEX3Aenvp_186220).Reqmethod185854 = copyStringRC1((*HEX3Aenvp_186220).Lineparts185832->data[0]);
				if (LOC21) nimGCunrefNoCycle(LOC21);
				nimln(170, "asynchttpserver.nim");
				if ((NU)(1) >= (NU)((*HEX3Aenvp_186220).Lineparts185832->Sup.len)) raiseIndexError();
				LOC22 = 0;
				LOC22 = (*HEX3Aenvp_186220).Path185855; (*HEX3Aenvp_186220).Path185855 = copyStringRC1((*HEX3Aenvp_186220).Lineparts185832->data[1]);
				if (LOC22) nimGCunrefNoCycle(LOC22);
				nimln(171, "asynchttpserver.nim");
				if ((NU)(2) >= (NU)((*HEX3Aenvp_186220).Lineparts185832->Sup.len)) raiseIndexError();
				LOC23 = 0;
				LOC23 = (*HEX3Aenvp_186220).Protocol185856; (*HEX3Aenvp_186220).Protocol185856 = copyStringRC1((*HEX3Aenvp_186220).Lineparts185832->data[2]);
				if (LOC23) nimGCunrefNoCycle(LOC23);
				nimln(174, "asynchttpserver.nim");
				(*HEX3Aenvp_186220).I185857 = 0;
				{
					nimln(175, "asynchttpserver.nim");
					while (1) {
						nimln(176, "asynchttpserver.nim");
						(*HEX3Aenvp_186220).I185857 = 0;
						nimln(177, "asynchttpserver.nim");
						asgnRef((void**) (&(*HEX3Aenvp_186220).Future185595), recvline_182302((*HEX3Aenvp_186220).Client185605, 2));
						nimln(177, "asynchttpserver.nim");
						(*HEX3Aenvp_186220).HEX3Astate = 3;
						nimln(177, "asynchttpserver.nim");
						nimln(1137, "asyncdispatch.nim");
						result = &(*HEX3Aenvp_186220).Future185595->Sup;
						goto BeforeRet;
						STATE3: ;
						nimln(177, "asynchttpserver.nim");
						asgnRefNoCycle((void**) (&(*HEX3Aenvp_186220).Headerline185869), read_170677((*HEX3Aenvp_186220).Future185595));
						nimln(178, "asynchttpserver.nim");
						{
							nimln(178, "asynchttpserver.nim");
							if (!(((*HEX3Aenvp_186220).Headerline185869) && ((*HEX3Aenvp_186220).Headerline185869)->Sup.len == 0)) goto LA28;
							nimln(179, "asynchttpserver.nim");
							close_183215((*HEX3Aenvp_186220).Client185605);
							nimln(1576, "os.nim");
							complete_160087((*HEX3Aenvp_186220).Retfuture185591);
							nimln(179, "asynchttpserver.nim");
							(*HEX3Aenvp_186220).HEX3Astate = -1;
							nimln(179, "asynchttpserver.nim");
							nimln(1576, "os.nim");
							result = NIM_NIL;
							goto BeforeRet;
						}
						LA28: ;
						nimln(180, "asynchttpserver.nim");
						{
							nimln(180, "asynchttpserver.nim");
							if (!eqStrings((*HEX3Aenvp_186220).Headerline185869, ((NimStringDesc*) &TMP604))) goto LA32;
							nimln(180, "asynchttpserver.nim");
							goto LA24;
						}
						LA32: ;
						nimln(183, "asynchttpserver.nim");
						parseheader_185450((*HEX3Aenvp_186220).Headerline185869, (&(*HEX3Aenvp_186220).Kv185872));
						nimln(184, "asynchttpserver.nim");
						nstPut((*HEX3Aenvp_186220).Request185626.Headers, (*HEX3Aenvp_186220).Kv185872.Field0, (*HEX3Aenvp_186220).Kv185872.Field1);
					}
				} LA24: ;
				nimln(186, "asynchttpserver.nim");
				LOC34 = 0;
				LOC34 = (*HEX3Aenvp_186220).Request185626.Reqmethod; (*HEX3Aenvp_186220).Request185626.Reqmethod = copyStringRC1((*HEX3Aenvp_186220).Reqmethod185854);
				if (LOC34) nimGCunrefNoCycle(LOC34);
				nimln(187, "asynchttpserver.nim");
				parseuri_184187((*HEX3Aenvp_186220).Path185855, (&(*HEX3Aenvp_186220).Request185626.Url));
				nimln(188, "asynchttpserver.nim");
				pushSafePoint(&TMP647);
				TMP647.status = _setjmp(TMP647.context);
				if (TMP647.status == 0) {
					nimln(189, "asynchttpserver.nim");
					parseprotocol_185503((*HEX3Aenvp_186220).Protocol185856, (&(*HEX3Aenvp_186220).Request185626.Protocol));
					popSafePoint();
				}
				else {
					popSafePoint();
					setFrame((TFrame*)&F);
					if (isObj(getCurrentException()->Sup.m_type, (&NTI3249))) {
						NimStringDesc* LOC38;
						TY185182 LOC39;
						stringtableobj173012* LOC40;
						futureHEX3Aobjecttype160094* LOC41;
						TMP647.status = 0;
						nimln(191, "asynchttpserver.nim");
						nimln(191, "asynchttpserver.nim");
						nimln(191, "asynchttpserver.nim");
						LOC38 = 0;
						LOC38 = rawNewString((*HEX3Aenvp_186220).Protocol185856->Sup.len + 31);
appendString(LOC38, ((NimStringDesc*) &TMP630));
appendString(LOC38, (*HEX3Aenvp_186220).Protocol185856);
						nimln(111, "asynchttpserver.nim");
						memset((void*)LOC39, 0, sizeof(LOC39));
						LOC40 = 0;
						LOC40 = nstnewStringTableWithTableConstr(LOC39, 0, ((NU8) 0));
						LOC41 = 0;
						LOC41 = respond_185168((&(*HEX3Aenvp_186220).Request185626), ((NU8) 15), LOC38, LOC40);
						asynccheck_185875(LOC41);
						popCurrentException();
						nimln(193, "asynchttpserver.nim");
						goto LA4;
						popCurrentException();
					}
				}
				if (TMP647.status != 0) reraiseException();
				nimln(195, "asynchttpserver.nim");
				{
					NimStringDesc* LOC44;
					nimln(195, "asynchttpserver.nim");
					nimln(195, "asynchttpserver.nim");
					LOC44 = 0;
					LOC44 = nsuNormalize((*HEX3Aenvp_186220).Reqmethod185854);
					if (!eqStrings(LOC44, ((NimStringDesc*) &TMP650))) goto LA45;
					nimln(197, "asynchttpserver.nim");
					{
						NIM_BOOL LOC49;
						nimln(197, "asynchttpserver.nim");
						LOC49 = 0;
						LOC49 = nsthasKey((*HEX3Aenvp_186220).Request185626.Headers, ((NimStringDesc*) &TMP651));
						if (!LOC49) goto LA50;
						nimln(198, "asynchttpserver.nim");
						{
							NimStringDesc* LOC54;
							NimStringDesc* LOC55;
							nimln(198, "asynchttpserver.nim");
							nimln(198, "asynchttpserver.nim");
							nimln(198, "asynchttpserver.nim");
							LOC54 = 0;
							LOC54 = nstGet((*HEX3Aenvp_186220).Request185626.Headers, ((NimStringDesc*) &TMP651));
							LOC55 = 0;
							LOC55 = nsuToLowerStr(LOC54);
							if (!eqStrings(LOC55, ((NimStringDesc*) &TMP652))) goto LA56;
							nimln(199, "asynchttpserver.nim");
							asgnRef((void**) (&(*HEX3Aenvp_186220).Future185596), sendstatus_185577((*HEX3Aenvp_186220).Client185605, ((NimStringDesc*) &TMP653)));
							nimln(199, "asynchttpserver.nim");
							(*HEX3Aenvp_186220).HEX3Astate = 4;
							nimln(199, "asynchttpserver.nim");
							nimln(1137, "asyncdispatch.nim");
							result = &(*HEX3Aenvp_186220).Future185596->Sup;
							goto BeforeRet;
							STATE4: ;
							nimln(199, "asynchttpserver.nim");
							read_175625((*HEX3Aenvp_186220).Future185596);
						}
						goto LA52;
						LA56: ;
						{
							nimln(201, "asynchttpserver.nim");
							asgnRef((void**) (&(*HEX3Aenvp_186220).Future185597), sendstatus_185577((*HEX3Aenvp_186220).Client185605, ((NimStringDesc*) &TMP654)));
							nimln(201, "asynchttpserver.nim");
							(*HEX3Aenvp_186220).HEX3Astate = 5;
							nimln(201, "asynchttpserver.nim");
							nimln(1137, "asyncdispatch.nim");
							result = &(*HEX3Aenvp_186220).Future185597->Sup;
							goto BeforeRet;
							STATE5: ;
							nimln(201, "asynchttpserver.nim");
							read_175625((*HEX3Aenvp_186220).Future185597);
						}
						LA52: ;
					}
					LA50: ;
					nimln(205, "asynchttpserver.nim");
					{
						NIM_BOOL LOC61;
						nimln(205, "asynchttpserver.nim");
						LOC61 = 0;
						LOC61 = nsthasKey((*HEX3Aenvp_186220).Request185626.Headers, ((NimStringDesc*) &TMP614));
						if (!LOC61) goto LA62;
						nimln(206, "asynchttpserver.nim");
						(*HEX3Aenvp_186220).Contentlength185927 = 0;
						nimln(207, "asynchttpserver.nim");
						{
							NimStringDesc* LOC66;
							NI LOC67;
							TY185182 LOC70;
							stringtableobj173012* LOC71;
							nimln(207, "asynchttpserver.nim");
							nimln(207, "asynchttpserver.nim");
							nimln(207, "asynchttpserver.nim");
							LOC66 = 0;
							LOC66 = nstGet((*HEX3Aenvp_186220).Request185626.Headers, ((NimStringDesc*) &TMP614));
							LOC67 = 0;
							LOC67 = npuParseInt(LOC66, (&(*HEX3Aenvp_186220).Contentlength185927), 0);
							if (!(LOC67 == 0)) goto LA68;
							nimln(208, "asynchttpserver.nim");
							nimln(111, "asynchttpserver.nim");
							memset((void*)LOC70, 0, sizeof(LOC70));
							LOC71 = 0;
							LOC71 = nstnewStringTableWithTableConstr(LOC70, 0, ((NU8) 0));
							asgnRef((void**) (&(*HEX3Aenvp_186220).Future185598), respond_185168((&(*HEX3Aenvp_186220).Request185626), ((NU8) 15), ((NimStringDesc*) &TMP655), LOC71));
							nimln(208, "asynchttpserver.nim");
							(*HEX3Aenvp_186220).HEX3Astate = 6;
							nimln(208, "asynchttpserver.nim");
							nimln(1137, "asyncdispatch.nim");
							result = &(*HEX3Aenvp_186220).Future185598->Sup;
							goto BeforeRet;
							STATE6: ;
							nimln(208, "asynchttpserver.nim");
							read_175625((*HEX3Aenvp_186220).Future185598);
						}
						goto LA64;
						LA68: ;
						{
							nimln(210, "asynchttpserver.nim");
							asgnRef((void**) (&(*HEX3Aenvp_186220).Future185599), recv_178443((*HEX3Aenvp_186220).Client185605, (*HEX3Aenvp_186220).Contentlength185927, 2));
							nimln(210, "asynchttpserver.nim");
							(*HEX3Aenvp_186220).HEX3Astate = 7;
							nimln(210, "asynchttpserver.nim");
							nimln(1137, "asyncdispatch.nim");
							result = &(*HEX3Aenvp_186220).Future185599->Sup;
							goto BeforeRet;
							STATE7: ;
							nimln(210, "asynchttpserver.nim");
							asgnRefNoCycle((void**) (&(*HEX3Aenvp_186220).Request185626.Body), read_170677((*HEX3Aenvp_186220).Future185599));
							nimln(211, "asynchttpserver.nim");
							{
								nimln(211, "asynchttpserver.nim");
								nimln(211, "asynchttpserver.nim");
								nimln(211, "asynchttpserver.nim");
								if (!!(((*HEX3Aenvp_186220).Request185626.Body->Sup.len == (*HEX3Aenvp_186220).Contentlength185927))) goto LA75;
								nimln(211, "asynchttpserver.nim");
								failedassertimpl_85425(((NimStringDesc*) &TMP656));
							}
							LA75: ;
						}
						LA64: ;
					}
					goto LA59;
					LA62: ;
					{
						TY185182 LOC78;
						stringtableobj173012* LOC79;
						nimln(213, "asynchttpserver.nim");
						nimln(111, "asynchttpserver.nim");
						memset((void*)LOC78, 0, sizeof(LOC78));
						LOC79 = 0;
						LOC79 = nstnewStringTableWithTableConstr(LOC78, 0, ((NU8) 0));
						asgnRef((void**) (&(*HEX3Aenvp_186220).Future185600), respond_185168((&(*HEX3Aenvp_186220).Request185626), ((NU8) 15), ((NimStringDesc*) &TMP657), LOC79));
						nimln(213, "asynchttpserver.nim");
						(*HEX3Aenvp_186220).HEX3Astate = 8;
						nimln(213, "asynchttpserver.nim");
						nimln(1137, "asyncdispatch.nim");
						result = &(*HEX3Aenvp_186220).Future185600->Sup;
						goto BeforeRet;
						STATE8: ;
						nimln(213, "asynchttpserver.nim");
						read_175625((*HEX3Aenvp_186220).Future185600);
						nimln(214, "asynchttpserver.nim");
						goto LA4;
					}
					LA59: ;
				}
				LA45: ;
				nimln(216, "asynchttpserver.nim");
				nimln(216, "asynchttpserver.nim");
				LOC80 = 0;
				LOC80 = nsuNormalize((*HEX3Aenvp_186220).Reqmethod185854);
				switch (hashString(LOC80) & 15) {
				case 0: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP662))) goto LA81;
break;
				case 1: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP659))) goto LA81;
break;
				case 4: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP650))) goto LA81;
break;
				case 5: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP660))) goto LA81;
break;
				case 6: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP663))) goto LA81;
break;
				case 7: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP661))) goto LA81;
break;
				case 9: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP664))) goto LA81;
break;
				case 12: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP658))) goto LA81;
break;
				case 14: 
if (eqStrings(LOC80, ((NimStringDesc*) &TMP665))) goto LA81;
break;
				}
				goto LA82;
				LA81: ;
				{
					nimln(218, "asynchttpserver.nim");
					asgnRef((void**) (&(*HEX3Aenvp_186220).Future185601), (*HEX3Aenvp_186220).Callback185612.ClEnv? (*HEX3Aenvp_186220).Callback185612.ClPrc((&(*HEX3Aenvp_186220).Request185626), (*HEX3Aenvp_186220).Callback185612.ClEnv):((TMP666)((*HEX3Aenvp_186220).Callback185612.ClPrc))((&(*HEX3Aenvp_186220).Request185626)));
					nimln(218, "asynchttpserver.nim");
					(*HEX3Aenvp_186220).HEX3Astate = 9;
					nimln(218, "asynchttpserver.nim");
					nimln(1137, "asyncdispatch.nim");
					result = &(*HEX3Aenvp_186220).Future185601->Sup;
					goto BeforeRet;
					STATE9: ;
					nimln(218, "asynchttpserver.nim");
					read_175625((*HEX3Aenvp_186220).Future185601);
				}
				goto LA83;
				LA82: ;
				{
					NimStringDesc* LOC86;
					TY185182 LOC87;
					stringtableobj173012* LOC88;
					nimln(220, "asynchttpserver.nim");
					nimln(220, "asynchttpserver.nim");
					LOC86 = 0;
					LOC86 = rawNewString((*HEX3Aenvp_186220).Reqmethod185854->Sup.len + 29);
appendString(LOC86, ((NimStringDesc*) &TMP667));
appendString(LOC86, (*HEX3Aenvp_186220).Reqmethod185854);
					nimln(111, "asynchttpserver.nim");
					memset((void*)LOC87, 0, sizeof(LOC87));
					LOC88 = 0;
					LOC88 = nstnewStringTableWithTableConstr(LOC87, 0, ((NU8) 0));
					asgnRef((void**) (&(*HEX3Aenvp_186220).Future185602), respond_185168((&(*HEX3Aenvp_186220).Request185626), ((NU8) 15), LOC86, LOC88));
					nimln(220, "asynchttpserver.nim");
					(*HEX3Aenvp_186220).HEX3Astate = 10;
					nimln(220, "asynchttpserver.nim");
					nimln(1137, "asyncdispatch.nim");
					result = &(*HEX3Aenvp_186220).Future185602->Sup;
					goto BeforeRet;
					STATE10: ;
					nimln(220, "asynchttpserver.nim");
					read_175625((*HEX3Aenvp_186220).Future185602);
				}
				LA83: ;
				nimln(223, "asynchttpserver.nim");
				{
					NIM_BOOL LOC91;
					NIM_BOOL LOC92;
					NimStringDesc* LOC94;
					NimStringDesc* LOC95;
					NIM_BOOL LOC97;
					NimStringDesc* LOC99;
					NimStringDesc* LOC100;
					nimln(224, "asynchttpserver.nim");
					LOC91 = 0;
					nimln(223, "asynchttpserver.nim");
					LOC92 = 0;
					nimln(223, "asynchttpserver.nim");
					LOC92 = HEX3DHEX3D_185072((&(*HEX3Aenvp_186220).Request185626.Protocol), ((NU8) 0));
					if (!(LOC92)) goto LA93;
					nimln(224, "asynchttpserver.nim");
					nimln(224, "asynchttpserver.nim");
					nimln(224, "asynchttpserver.nim");
					nimln(224, "asynchttpserver.nim");
					LOC94 = 0;
					LOC94 = nstGet((*HEX3Aenvp_186220).Request185626.Headers, ((NimStringDesc*) &TMP668));
					LOC95 = 0;
					LOC95 = nsuNormalize(LOC94);
					LOC92 = !(eqStrings(LOC95, ((NimStringDesc*) &TMP669)));
					LA93: ;
					LOC91 = LOC92;
					if (LOC91) goto LA96;
					nimln(225, "asynchttpserver.nim");
					LOC97 = 0;
					nimln(225, "asynchttpserver.nim");
					LOC97 = HEX3DHEX3D_185072((&(*HEX3Aenvp_186220).Request185626.Protocol), ((NU8) 1));
					if (!(LOC97)) goto LA98;
					nimln(226, "asynchttpserver.nim");
					nimln(226, "asynchttpserver.nim");
					nimln(226, "asynchttpserver.nim");
					LOC99 = 0;
					LOC99 = nstGet((*HEX3Aenvp_186220).Request185626.Headers, ((NimStringDesc*) &TMP668));
					LOC100 = 0;
					LOC100 = nsuNormalize(LOC99);
					LOC97 = eqStrings(LOC100, ((NimStringDesc*) &TMP670));
					LA98: ;
					LOC91 = LOC97;
					LA96: ;
					if (!LOC91) goto LA101;
				}
				goto LA89;
				LA101: ;
				{
					nimln(233, "asynchttpserver.nim");
					close_183215((*HEX3Aenvp_186220).Request185626.Client);
					nimln(234, "asynchttpserver.nim");
					goto LA1;
				}
				LA89: ;
			} LA4: ;
		} LA2: ;
	} LA1: ;
	nimln(1576, "os.nim");
	complete_160087((*HEX3Aenvp_186220).Retfuture185591);
	nimln(1287, "asyncdispatch.nim");
	(*HEX3Aenvp_186220).HEX3Astate = -1;
	BeforeRet: ;
	popFrame();
	return result;
}

N_CLOSURE(void, cb_186040)(void* ClEnv) {
	TY186214* HEX3Aenvp_186229;
	TSafePoint TMP671;
	nimfr("cb", "asyncdispatch.nim")
	HEX3Aenvp_186229 = (TY186214*) ClEnv;
	nimln(1068, "asyncdispatch.nim");
	pushSafePoint(&TMP671);
	TMP671.status = _setjmp(TMP671.context);
	if (TMP671.status == 0) {
		nimln(1069, "asyncdispatch.nim");
		{
			NIM_BOOL LOC4;
			futurebaseHEX3Aobjecttype160014* next_186039;
			nimln(1069, "asyncdispatch.nim");
			nimln(1069, "asyncdispatch.nim");
			LOC4 = 0;
			LOC4 = finished_171246((*HEX3Aenvp_186229).Nameitervar186037);
			if (!!(LOC4)) goto LA5;
			nimln(1070, "asyncdispatch.nim");
			next_186039 = (*HEX3Aenvp_186229).Nameitervar186037.ClPrc((*HEX3Aenvp_186229).Nameitervar186037.ClEnv);
			nimln(1071, "asyncdispatch.nim");
			{
				nimln(1071, "asyncdispatch.nim");
				if (!(next_186039 == NIM_NIL)) goto LA9;
				nimln(1072, "asyncdispatch.nim");
				{
					nimln(1072, "asyncdispatch.nim");
					if (!!((*(*HEX3Aenvp_186229).Retfuture185591).Sup.Finished)) goto LA13;
					nimln(1072, "asyncdispatch.nim");
					failedassertimpl_85425(((NimStringDesc*) &TMP673));
				}
				LA13: ;
			}
			goto LA7;
			LA9: ;
			{
				TY160015 LOC16;
				nimln(1075, "asyncdispatch.nim");
				memset((void*)(&LOC16), 0, sizeof(LOC16));
				LOC16.ClPrc = cb_186040; LOC16.ClEnv = HEX3Aenvp_186229;
				callbackHEX3D_160849(next_186039, LOC16);
			}
			LA7: ;
		}
		LA5: ;
		popSafePoint();
	}
	else {
		popSafePoint();
		setFrame((TFrame*)&F);
		{
			TMP671.status = 0;
			nimln(1077, "asyncdispatch.nim");
			{
				if (!(*(*HEX3Aenvp_186229).Retfuture185591).Sup.Finished) goto LA21;
				nimln(1080, "asyncdispatch.nim");
				reraiseException();
			}
			goto LA19;
			LA21: ;
			{
				Exception* LOC24;
				nimln(1082, "asyncdispatch.nim");
				nimln(1082, "asyncdispatch.nim");
				LOC24 = 0;
				LOC24 = getCurrentException();
				fail_165669((*HEX3Aenvp_186229).Retfuture185591, LOC24);
			}
			LA19: ;
			popCurrentException();
		}
	}
	if (TMP671.status != 0) reraiseException();
	popFrame();
}

N_NIMCALL(futureHEX3Aobjecttype160094*, processclient_185603)(asyncsocketdesc175202* client, NimStringDesc* address, TY185607 callback) {
	futureHEX3Aobjecttype160094* result;
	TY186214* HEX3Aenv_186232;
	NimStringDesc* LOC1;
	TY170666 LOC2;
	TY160015 LOC3;
	nimfr("processClient", "asynchttpserver.nim")
	result = 0;
	HEX3Aenv_186232 = 0;
	nimln(172, "system.nim");
	HEX3Aenv_186232 = (TY186214*) newObj((&NTI186233), sizeof(TY186214));
	nimln(150, "asynchttpserver.nim");
	asgnRefNoCycle((void**) (&(*HEX3Aenv_186232).Client185605), client);
	nimln(150, "asynchttpserver.nim");
	LOC1 = 0;
	LOC1 = (*HEX3Aenv_186232).Address185606; (*HEX3Aenv_186232).Address185606 = copyStringRC1(address);
	if (LOC1) nimGCunrefNoCycle(LOC1);
	nimln(150, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenv_186232).Callback185612.ClEnv), callback.ClEnv);
	(*HEX3Aenv_186232).Callback185612.ClPrc = callback.ClPrc;
	nimln(147, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenv_186232).Retfuture185591), newfuture_165426(((NimStringDesc*) &TMP642)));
	nimln(1065, "asyncdispatch.nim");
	memset((void*)(&LOC2), 0, sizeof(LOC2));
	LOC2.ClPrc = processclientiter_185592; LOC2.ClEnv = HEX3Aenv_186232;
	asgnRef((void**) (&(*HEX3Aenv_186232).Nameitervar186037.ClEnv), LOC2.ClEnv);
	(*HEX3Aenv_186232).Nameitervar186037.ClPrc = LOC2.ClPrc;
	nimln(1083, "asyncdispatch.nim");
	memset((void*)(&LOC3), 0, sizeof(LOC3));
	LOC3.ClPrc = cb_186040; LOC3.ClEnv = HEX3Aenv_186232;
	LOC3.ClEnv? LOC3.ClPrc(LOC3.ClEnv):((TMP674)(LOC3.ClPrc))();
	nimln(1576, "os.nim");
	nimln(1271, "asyncdispatch.nim");
	result = (*HEX3Aenv_186232).Retfuture185591;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}
N_NIMCALL(void, TMP676)(void* p, NI op) {
	TY186414* a;
	a = (TY186414*)p;
	nimGCvisit((void*)(*a).Server186266, op);
	nimGCvisit((void*)(*a).Address186274, op);
	nimGCvisit((void*)(*a).Callback186273.ClEnv, op);
	nimGCvisit((void*)(*a).Retfuture186261, op);
	nimGCvisit((void*)(*a).Nameitervar186314.ClEnv, op);
	nimGCvisit((void*)(*a).Future186263, op);
	nimGCvisit((void*)(*a).Fut186299.Field0, op);
	nimGCvisit((void*)(*a).Fut186299.Field1, op);
}

N_CLOSURE(futurebaseHEX3Aobjecttype160014*, serveiter_186262)(void* ClEnv) {
	futurebaseHEX3Aobjecttype160014* result;
	TY186414* HEX3Aenvp_186420;
	nimfr("serveIter", "asyncdispatch.nim")
	result = 0;
	HEX3Aenvp_186420 = (TY186414*) ClEnv;
	switch ((*HEX3Aenvp_186420).HEX3Astate) {
	case -1: goto BeforeRet;
	case 0: goto STATE0;
	case 1: goto STATE1;
	}
	STATE0: ;
	nimln(243, "asynchttpserver.nim");
	asgnRefNoCycle((void**) (&(*(*HEX3Aenvp_186420).Server186266).Socket), newasyncsocket_175439(((NU8) 2), ((NU8) 1), ((NU8) 6), NIM_TRUE));
	nimln(244, "asynchttpserver.nim");
	{
		if (!(*(*HEX3Aenvp_186420).Server186266).Reuseaddr) goto LA3;
		nimln(245, "asynchttpserver.nim");
		setsockopt_183615((*(*HEX3Aenvp_186420).Server186266).Socket, ((NU8) 6), NIM_TRUE, SOL_SOCKET);
	}
	LA3: ;
	nimln(246, "asynchttpserver.nim");
	bindaddr_183056((*(*HEX3Aenvp_186420).Server186266).Socket, (*HEX3Aenvp_186420).Port186267, (*HEX3Aenvp_186420).Address186274);
	nimln(247, "asynchttpserver.nim");
	listen_183045((*(*HEX3Aenvp_186420).Server186266).Socket, SOMAXCONN);
	{
		nimln(249, "asynchttpserver.nim");
		while (1) {
			futureHEX3Aobjecttype160094* LOC7;
			nimln(252, "asynchttpserver.nim");
			asgnRef((void**) (&(*HEX3Aenvp_186420).Future186263), acceptaddr_179438((*(*HEX3Aenvp_186420).Server186266).Socket, 2));
			nimln(252, "asynchttpserver.nim");
			(*HEX3Aenvp_186420).HEX3Astate = 1;
			nimln(252, "asynchttpserver.nim");
			nimln(1137, "asyncdispatch.nim");
			result = &(*HEX3Aenvp_186420).Future186263->Sup;
			goto BeforeRet;
			STATE1: ;
			nimln(252, "asynchttpserver.nim");
			read_181619((*HEX3Aenvp_186420).Future186263, (&(*HEX3Aenvp_186420).Fut186299));
			nimln(253, "asynchttpserver.nim");
			nimln(253, "asynchttpserver.nim");
			LOC7 = 0;
			LOC7 = processclient_185603((*HEX3Aenvp_186420).Fut186299.Field1, (*HEX3Aenvp_186420).Fut186299.Field0, (*HEX3Aenvp_186420).Callback186273);
			asynccheck_185875(LOC7);
		}
	}
	nimln(253, "asynchttpserver.nim");
	complete_160087((*HEX3Aenvp_186420).Retfuture186261);
	nimln(1287, "asyncdispatch.nim");
	(*HEX3Aenvp_186420).HEX3Astate = -1;
	BeforeRet: ;
	popFrame();
	return result;
}

N_CLOSURE(void, cb_186317)(void* ClEnv) {
	TY186414* HEX3Aenvp_186430;
	TSafePoint TMP678;
	nimfr("cb", "asyncdispatch.nim")
	HEX3Aenvp_186430 = (TY186414*) ClEnv;
	nimln(1068, "asyncdispatch.nim");
	pushSafePoint(&TMP678);
	TMP678.status = _setjmp(TMP678.context);
	if (TMP678.status == 0) {
		nimln(1069, "asyncdispatch.nim");
		{
			NIM_BOOL LOC4;
			futurebaseHEX3Aobjecttype160014* next_186316;
			nimln(1069, "asyncdispatch.nim");
			nimln(1069, "asyncdispatch.nim");
			LOC4 = 0;
			LOC4 = finished_171246((*HEX3Aenvp_186430).Nameitervar186314);
			if (!!(LOC4)) goto LA5;
			nimln(1070, "asyncdispatch.nim");
			next_186316 = (*HEX3Aenvp_186430).Nameitervar186314.ClPrc((*HEX3Aenvp_186430).Nameitervar186314.ClEnv);
			nimln(1071, "asyncdispatch.nim");
			{
				nimln(1071, "asyncdispatch.nim");
				if (!(next_186316 == NIM_NIL)) goto LA9;
				nimln(1072, "asyncdispatch.nim");
				{
					nimln(1072, "asyncdispatch.nim");
					if (!!((*(*HEX3Aenvp_186430).Retfuture186261).Sup.Finished)) goto LA13;
					nimln(1072, "asyncdispatch.nim");
					failedassertimpl_85425(((NimStringDesc*) &TMP680));
				}
				LA13: ;
			}
			goto LA7;
			LA9: ;
			{
				TY160015 LOC16;
				nimln(1075, "asyncdispatch.nim");
				memset((void*)(&LOC16), 0, sizeof(LOC16));
				LOC16.ClPrc = cb_186317; LOC16.ClEnv = HEX3Aenvp_186430;
				callbackHEX3D_160849(next_186316, LOC16);
			}
			LA7: ;
		}
		LA5: ;
		popSafePoint();
	}
	else {
		popSafePoint();
		setFrame((TFrame*)&F);
		{
			TMP678.status = 0;
			nimln(1077, "asyncdispatch.nim");
			{
				if (!(*(*HEX3Aenvp_186430).Retfuture186261).Sup.Finished) goto LA21;
				nimln(1080, "asyncdispatch.nim");
				reraiseException();
			}
			goto LA19;
			LA21: ;
			{
				Exception* LOC24;
				nimln(1082, "asyncdispatch.nim");
				nimln(1082, "asyncdispatch.nim");
				LOC24 = 0;
				LOC24 = getCurrentException();
				fail_165669((*HEX3Aenvp_186430).Retfuture186261, LOC24);
			}
			LA19: ;
			popCurrentException();
		}
	}
	if (TMP678.status != 0) reraiseException();
	popFrame();
}

N_NIMCALL(futureHEX3Aobjecttype160094*, serve_186264)(asynchttpserverHEX3Aobjecttype185023* server, NU16 port, TY185607 callback, NimStringDesc* address) {
	futureHEX3Aobjecttype160094* result;
	TY186414* HEX3Aenv_186433;
	NimStringDesc* LOC1;
	TY170666 LOC2;
	TY160015 LOC3;
	nimfr("serve", "asynchttpserver.nim")
	result = 0;
	HEX3Aenv_186433 = 0;
	nimln(172, "system.nim");
	HEX3Aenv_186433 = (TY186414*) newObj((&NTI186434), sizeof(TY186414));
	nimln(239, "asynchttpserver.nim");
	asgnRefNoCycle((void**) (&(*HEX3Aenv_186433).Server186266), server);
	nimln(239, "asynchttpserver.nim");
	(*HEX3Aenv_186433).Port186267 = port;
	nimln(239, "asynchttpserver.nim");
	LOC1 = 0;
	LOC1 = (*HEX3Aenv_186433).Address186274; (*HEX3Aenv_186433).Address186274 = copyStringRC1(address);
	if (LOC1) nimGCunrefNoCycle(LOC1);
	nimln(239, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenv_186433).Callback186273.ClEnv), callback.ClEnv);
	(*HEX3Aenv_186433).Callback186273.ClPrc = callback.ClPrc;
	nimln(236, "asynchttpserver.nim");
	asgnRef((void**) (&(*HEX3Aenv_186433).Retfuture186261), newfuture_165426(((NimStringDesc*) &TMP677)));
	nimln(1065, "asyncdispatch.nim");
	memset((void*)(&LOC2), 0, sizeof(LOC2));
	LOC2.ClPrc = serveiter_186262; LOC2.ClEnv = HEX3Aenv_186433;
	asgnRef((void**) (&(*HEX3Aenv_186433).Nameitervar186314.ClEnv), LOC2.ClEnv);
	(*HEX3Aenv_186433).Nameitervar186314.ClPrc = LOC2.ClPrc;
	nimln(1083, "asyncdispatch.nim");
	memset((void*)(&LOC3), 0, sizeof(LOC3));
	LOC3.ClPrc = cb_186317; LOC3.ClEnv = HEX3Aenv_186433;
	LOC3.ClEnv? LOC3.ClPrc(LOC3.ClEnv):((TMP681)(LOC3.ClPrc))();
	nimln(253, "asynchttpserver.nim");
	nimln(1271, "asyncdispatch.nim");
	result = (*HEX3Aenv_186433).Retfuture186261;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, close_186440)(asynchttpserverHEX3Aobjecttype185023* server) {
	nimfr("close", "asynchttpserver.nim")
	nimln(259, "asynchttpserver.nim");
	close_183215((*server).Socket);
	popFrame();
}
NIM_EXTERNC N_NOINLINE(void, stdlib_asynchttpserverInit)(void) {
	nimfr("asynchttpserver", "asynchttpserver.nim")
	popFrame();
}

NIM_EXTERNC N_NOINLINE(void, stdlib_asynchttpserverDatInit)(void) {
static TNimNode* TMP601[2];
static TNimNode* TMP606[10];
static TNimNode* TMP607[33];
NI TMP609;
static char* NIM_CONST TMP608[33] = {
"100 Continue", 
"101 Switching Protocols", 
"200 OK", 
"201 Created", 
"202 Accepted", 
"204 No Content", 
"205 Reset Content", 
"206 Partial Content", 
"300 Multiple Choices", 
"301 Moved Permanently", 
"302 Found", 
"303 See Other", 
"304 Not Modified", 
"305 Use Proxy", 
"307 Temporary Redirect", 
"400 Bad Request", 
"401 Unauthorized", 
"403 Forbidden", 
"404 Not Found", 
"405 Method Not Allowed", 
"406 Not Acceptable", 
"407 Proxy Authentication Required", 
"408 Request Timeout", 
"409 Conflict", 
"410 Gone", 
"411 Length Required", 
"418 I\'m a teapot", 
"500 Internal Server Error", 
"501 Not Implemented", 
"502 Bad Gateway", 
"503 Service Unavailable", 
"504 Gateway Timeout", 
"505 HTTP Version Not Supported"};
static TNimNode* TMP610[7];
static TNimNode* TMP611[3];
static TNimNode* TMP639[26];
static TNimNode* TMP640[2];
static TNimNode* TMP675[9];
static TNimNode TMP438[100];
NTI185023.size = sizeof(asynchttpserverHEX3Aobjecttype185023);
NTI185023.kind = 18;
NTI185023.base = 0;
NTI185023.flags = 2;
TMP601[0] = &TMP438[1];
TMP438[1].kind = 1;
TMP438[1].offset = offsetof(asynchttpserverHEX3Aobjecttype185023, Socket);
TMP438[1].typ = (&NTI175204);
TMP438[1].name = "socket";
TMP601[1] = &TMP438[2];
TMP438[2].kind = 1;
TMP438[2].offset = offsetof(asynchttpserverHEX3Aobjecttype185023, Reuseaddr);
TMP438[2].typ = (&NTI138);
TMP438[2].name = "reuseAddr";
TMP438[0].len = 2; TMP438[0].kind = 2; TMP438[0].sons = &TMP601[0];
NTI185023.node = &TMP438[0];
NTI185007.size = sizeof(asynchttpserverHEX3Aobjecttype185023*);
NTI185007.kind = 22;
NTI185007.base = (&NTI185023);
NTI185007.flags = 2;
NTI185007.marker = TMP602;
NTI185414.size = sizeof(TY185414);
NTI185414.kind = 18;
NTI185414.base = 0;
TMP606[0] = &TMP438[4];
TMP438[4].kind = 1;
TMP438[4].offset = offsetof(TY185414, HEX3Astate);
TMP438[4].typ = (&NTI176416);
TMP438[4].name = ":state";
TMP606[1] = &TMP438[5];
TMP438[5].kind = 1;
TMP438[5].offset = offsetof(TY185414, Headers185183);
TMP438[5].typ = (&NTI173014);
TMP438[5].name = "headers185183";
TMP606[2] = &TMP438[6];
TMP438[6].kind = 1;
TMP438[6].offset = offsetof(TY185414, Content185172);
TMP438[6].typ = (&NTI149);
TMP438[6].name = "content185172";
TMP606[3] = &TMP438[7];
NTI185009.size = sizeof(NU8);
NTI185009.kind = 14;
NTI185009.base = 0;
NTI185009.flags = 3;
for (TMP609 = 0; TMP609 < 33; TMP609++) {
TMP438[TMP609+8].kind = 1;
TMP438[TMP609+8].offset = TMP609;
TMP438[TMP609+8].name = TMP608[TMP609];
TMP607[TMP609] = &TMP438[TMP609+8];
}
TMP438[41].len = 33; TMP438[41].kind = 2; TMP438[41].sons = &TMP607[0];
NTI185009.node = &TMP438[41];
TMP438[7].kind = 1;
TMP438[7].offset = offsetof(TY185414, Code185171);
TMP438[7].typ = (&NTI185009);
TMP438[7].name = "code185171";
TMP606[4] = &TMP438[42];
NTI185005.size = sizeof(request185005);
NTI185005.kind = 18;
NTI185005.base = 0;
TMP610[0] = &TMP438[44];
TMP438[44].kind = 1;
TMP438[44].offset = offsetof(request185005, Client);
TMP438[44].typ = (&NTI175204);
TMP438[44].name = "client";
TMP610[1] = &TMP438[45];
TMP438[45].kind = 1;
TMP438[45].offset = offsetof(request185005, Reqmethod);
TMP438[45].typ = (&NTI149);
TMP438[45].name = "reqMethod";
TMP610[2] = &TMP438[46];
TMP438[46].kind = 1;
TMP438[46].offset = offsetof(request185005, Headers);
TMP438[46].typ = (&NTI173014);
TMP438[46].name = "headers";
TMP610[3] = &TMP438[47];
NTI185074.size = sizeof(TY185074);
NTI185074.kind = 18;
NTI185074.base = 0;
NTI185074.flags = 2;
TMP611[0] = &TMP438[49];
TMP438[49].kind = 1;
TMP438[49].offset = offsetof(TY185074, Field0);
TMP438[49].typ = (&NTI149);
TMP438[49].name = "Field0";
TMP611[1] = &TMP438[50];
TMP438[50].kind = 1;
TMP438[50].offset = offsetof(TY185074, Field1);
TMP438[50].typ = (&NTI108);
TMP438[50].name = "Field1";
TMP611[2] = &TMP438[51];
TMP438[51].kind = 1;
TMP438[51].offset = offsetof(TY185074, Field2);
TMP438[51].typ = (&NTI108);
TMP438[51].name = "Field2";
TMP438[48].len = 3; TMP438[48].kind = 2; TMP438[48].sons = &TMP611[0];
NTI185074.node = &TMP438[48];
TMP438[47].kind = 1;
TMP438[47].offset = offsetof(request185005, Protocol);
TMP438[47].typ = (&NTI185074);
TMP438[47].name = "protocol";
TMP610[4] = &TMP438[52];
TMP438[52].kind = 1;
TMP438[52].offset = offsetof(request185005, Url);
TMP438[52].typ = (&NTI184012);
TMP438[52].name = "url";
TMP610[5] = &TMP438[53];
TMP438[53].kind = 1;
TMP438[53].offset = offsetof(request185005, Hostname);
TMP438[53].typ = (&NTI149);
TMP438[53].name = "hostname";
TMP610[6] = &TMP438[54];
TMP438[54].kind = 1;
TMP438[54].offset = offsetof(request185005, Body);
TMP438[54].typ = (&NTI149);
TMP438[54].name = "body";
TMP438[43].len = 7; TMP438[43].kind = 2; TMP438[43].sons = &TMP610[0];
NTI185005.node = &TMP438[43];
TMP438[42].kind = 1;
TMP438[42].offset = offsetof(TY185414, Req185170);
TMP438[42].typ = (&NTI185005);
TMP438[42].name = "req185170";
TMP606[5] = &TMP438[55];
TMP438[55].kind = 1;
TMP438[55].offset = offsetof(TY185414, Retfuture185165);
TMP438[55].typ = (&NTI160093);
TMP438[55].name = "retFuture185165";
TMP606[6] = &TMP438[56];
TMP438[56].kind = 1;
TMP438[56].offset = offsetof(TY185414, Nameitervar185220);
TMP438[56].typ = (&NTI170666);
TMP438[56].name = "nameIterVar185220";
TMP606[7] = &TMP438[57];
TMP438[57].kind = 1;
TMP438[57].offset = offsetof(TY185414, Customheaders185197);
TMP438[57].typ = (&NTI173014);
TMP438[57].name = "customHeaders185197";
TMP606[8] = &TMP438[58];
TMP438[58].kind = 1;
TMP438[58].offset = offsetof(TY185414, Msg185205);
TMP438[58].typ = (&NTI149);
TMP438[58].name = "msg185205";
TMP606[9] = &TMP438[59];
TMP438[59].kind = 1;
TMP438[59].offset = offsetof(TY185414, Future185167);
TMP438[59].typ = (&NTI160093);
TMP438[59].name = "future185167";
TMP438[3].len = 10; TMP438[3].kind = 2; TMP438[3].sons = &TMP606[0];
NTI185414.node = &TMP438[3];
NTI185434.size = sizeof(TY185414*);
NTI185434.kind = 22;
NTI185434.base = (&NTI185414);
NTI185434.marker = TMP612;
NTI186214.size = sizeof(TY186214);
NTI186214.kind = 18;
NTI186214.base = 0;
TMP639[0] = &TMP438[61];
NTI186216.size = sizeof(NI);
NTI186216.kind = 20;
NTI186216.base = (&NTI108);
NTI186216.flags = 3;
TMP438[61].kind = 1;
TMP438[61].offset = offsetof(TY186214, HEX3Astate);
TMP438[61].typ = (&NTI186216);
TMP438[61].name = ":state";
TMP639[1] = &TMP438[62];
TMP438[62].kind = 1;
TMP438[62].offset = offsetof(TY186214, Client185605);
TMP438[62].typ = (&NTI175204);
TMP438[62].name = "client185605";
TMP639[2] = &TMP438[63];
TMP438[63].kind = 1;
TMP438[63].offset = offsetof(TY186214, Address185606);
TMP438[63].typ = (&NTI149);
TMP438[63].name = "address185606";
TMP639[3] = &TMP438[64];
TMP438[64].kind = 1;
TMP438[64].offset = offsetof(TY186214, Retfuture185591);
TMP438[64].typ = (&NTI160093);
TMP438[64].name = "retFuture185591";
TMP639[4] = &TMP438[65];
NTI185607.size = sizeof(TY161264);
NTI185607.kind = 18;
NTI185607.base = 0;
NTI185607.flags = 2;
TMP640[0] = &TMP438[67];
TMP438[67].kind = 1;
TMP438[67].offset = offsetof(TY161264, Field0);
TMP438[67].typ = (&NTI153);
TMP438[67].name = "Field0";
TMP640[1] = &TMP438[68];
TMP438[68].kind = 1;
TMP438[68].offset = offsetof(TY161264, Field1);
TMP438[68].typ = (&NTI161266);
TMP438[68].name = "Field1";
TMP438[66].len = 2; TMP438[66].kind = 2; TMP438[66].sons = &TMP640[0];
NTI185607.node = &TMP438[66];
TMP438[65].kind = 1;
TMP438[65].offset = offsetof(TY186214, Callback185612);
TMP438[65].typ = (&NTI185607);
TMP438[65].name = "callback185612";
TMP639[5] = &TMP438[69];
TMP438[69].kind = 1;
TMP438[69].offset = offsetof(TY186214, Nameitervar186037);
TMP438[69].typ = (&NTI170666);
TMP438[69].name = "nameIterVar186037";
TMP639[6] = &TMP438[70];
TMP438[70].kind = 1;
TMP438[70].offset = offsetof(TY186214, Request185626);
TMP438[70].typ = (&NTI185005);
TMP438[70].name = "request185626";
TMP639[7] = &TMP438[71];
TMP438[71].kind = 1;
TMP438[71].offset = offsetof(TY186214, Future185593);
TMP438[71].typ = (&NTI165747);
TMP438[71].name = "future185593";
TMP639[8] = &TMP438[72];
TMP438[72].kind = 1;
TMP438[72].offset = offsetof(TY186214, Line185829);
TMP438[72].typ = (&NTI149);
TMP438[72].name = "line185829";
TMP639[9] = &TMP438[73];
TMP438[73].kind = 1;
TMP438[73].offset = offsetof(TY186214, Lineparts185832);
TMP438[73].typ = (&NTI13406);
TMP438[73].name = "lineParts185832";
TMP639[10] = &TMP438[74];
TMP438[74].kind = 1;
TMP438[74].offset = offsetof(TY186214, Future185594);
TMP438[74].typ = (&NTI160093);
TMP438[74].name = "future185594";
TMP639[11] = &TMP438[75];
TMP438[75].kind = 1;
TMP438[75].offset = offsetof(TY186214, Reqmethod185854);
TMP438[75].typ = (&NTI149);
TMP438[75].name = "reqMethod185854";
TMP639[12] = &TMP438[76];
TMP438[76].kind = 1;
TMP438[76].offset = offsetof(TY186214, Path185855);
TMP438[76].typ = (&NTI149);
TMP438[76].name = "path185855";
TMP639[13] = &TMP438[77];
TMP438[77].kind = 1;
TMP438[77].offset = offsetof(TY186214, Protocol185856);
TMP438[77].typ = (&NTI149);
TMP438[77].name = "protocol185856";
TMP639[14] = &TMP438[78];
TMP438[78].kind = 1;
TMP438[78].offset = offsetof(TY186214, I185857);
TMP438[78].typ = (&NTI108);
TMP438[78].name = "i185857";
TMP639[15] = &TMP438[79];
TMP438[79].kind = 1;
TMP438[79].offset = offsetof(TY186214, Future185595);
TMP438[79].typ = (&NTI165747);
TMP438[79].name = "future185595";
TMP639[16] = &TMP438[80];
TMP438[80].kind = 1;
TMP438[80].offset = offsetof(TY186214, Headerline185869);
TMP438[80].typ = (&NTI149);
TMP438[80].name = "headerLine185869";
TMP639[17] = &TMP438[81];
TMP438[81].kind = 1;
TMP438[81].offset = offsetof(TY186214, Kv185872);
TMP438[81].typ = (&NTI109352);
TMP438[81].name = "kv185872";
TMP639[18] = &TMP438[82];
TMP438[82].kind = 1;
TMP438[82].offset = offsetof(TY186214, Future185596);
TMP438[82].typ = (&NTI160093);
TMP438[82].name = "future185596";
TMP639[19] = &TMP438[83];
TMP438[83].kind = 1;
TMP438[83].offset = offsetof(TY186214, Future185597);
TMP438[83].typ = (&NTI160093);
TMP438[83].name = "future185597";
TMP639[20] = &TMP438[84];
TMP438[84].kind = 1;
TMP438[84].offset = offsetof(TY186214, Contentlength185927);
TMP438[84].typ = (&NTI108);
TMP438[84].name = "contentLength185927";
TMP639[21] = &TMP438[85];
TMP438[85].kind = 1;
TMP438[85].offset = offsetof(TY186214, Future185598);
TMP438[85].typ = (&NTI160093);
TMP438[85].name = "future185598";
TMP639[22] = &TMP438[86];
TMP438[86].kind = 1;
TMP438[86].offset = offsetof(TY186214, Future185599);
TMP438[86].typ = (&NTI165747);
TMP438[86].name = "future185599";
TMP639[23] = &TMP438[87];
TMP438[87].kind = 1;
TMP438[87].offset = offsetof(TY186214, Future185600);
TMP438[87].typ = (&NTI160093);
TMP438[87].name = "future185600";
TMP639[24] = &TMP438[88];
TMP438[88].kind = 1;
TMP438[88].offset = offsetof(TY186214, Future185601);
TMP438[88].typ = (&NTI160093);
TMP438[88].name = "future185601";
TMP639[25] = &TMP438[89];
TMP438[89].kind = 1;
TMP438[89].offset = offsetof(TY186214, Future185602);
TMP438[89].typ = (&NTI160093);
TMP438[89].name = "future185602";
TMP438[60].len = 26; TMP438[60].kind = 2; TMP438[60].sons = &TMP639[0];
NTI186214.node = &TMP438[60];
NTI186233.size = sizeof(TY186214*);
NTI186233.kind = 22;
NTI186233.base = (&NTI186214);
NTI186233.marker = TMP641;
NTI186414.size = sizeof(TY186414);
NTI186414.kind = 18;
NTI186414.base = 0;
TMP675[0] = &TMP438[91];
TMP438[91].kind = 1;
TMP438[91].offset = offsetof(TY186414, HEX3Astate);
TMP438[91].typ = (&NTI176416);
TMP438[91].name = ":state";
TMP675[1] = &TMP438[92];
TMP438[92].kind = 1;
TMP438[92].offset = offsetof(TY186414, Server186266);
TMP438[92].typ = (&NTI185007);
TMP438[92].name = "server186266";
TMP675[2] = &TMP438[93];
TMP438[93].kind = 1;
TMP438[93].offset = offsetof(TY186414, Port186267);
TMP438[93].typ = (&NTI122);
TMP438[93].name = "port186267";
TMP675[3] = &TMP438[94];
TMP438[94].kind = 1;
TMP438[94].offset = offsetof(TY186414, Address186274);
TMP438[94].typ = (&NTI149);
TMP438[94].name = "address186274";
TMP675[4] = &TMP438[95];
TMP438[95].kind = 1;
TMP438[95].offset = offsetof(TY186414, Callback186273);
TMP438[95].typ = (&NTI185607);
TMP438[95].name = "callback186273";
TMP675[5] = &TMP438[96];
TMP438[96].kind = 1;
TMP438[96].offset = offsetof(TY186414, Retfuture186261);
TMP438[96].typ = (&NTI160093);
TMP438[96].name = "retFuture186261";
TMP675[6] = &TMP438[97];
TMP438[97].kind = 1;
TMP438[97].offset = offsetof(TY186414, Nameitervar186314);
TMP438[97].typ = (&NTI170666);
TMP438[97].name = "nameIterVar186314";
TMP675[7] = &TMP438[98];
TMP438[98].kind = 1;
TMP438[98].offset = offsetof(TY186414, Future186263);
TMP438[98].typ = (&NTI179451);
TMP438[98].name = "future186263";
TMP675[8] = &TMP438[99];
TMP438[99].kind = 1;
TMP438[99].offset = offsetof(TY186414, Fut186299);
TMP438[99].typ = (&NTI179445);
TMP438[99].name = "fut186299";
TMP438[90].len = 9; TMP438[90].kind = 2; TMP438[90].sons = &TMP675[0];
NTI186414.node = &TMP438[90];
NTI186434.size = sizeof(TY186414*);
NTI186434.kind = 22;
NTI186434.base = (&NTI186414);
NTI186434.marker = TMP676;
}

